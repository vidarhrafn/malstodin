<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>🎧 Hlustun: Jónas rífur sig upp – Málstöðin</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Ef þú ert með notandauth eins og áður -->
  <script src="/isat1ic/auth.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    .sticky-player { position: sticky; top: 0; z-index: 50; background: white; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .answer-option { border: 2px solid #e0e0e0; transition: all 0.2s; cursor: pointer; }
    .answer-option:hover:not(.disabled) { border-color:#2196f3; background:#e3f2fd; }
    .answer-option.selected { border-color:#2196f3; background:#e3f2fd; }
    .answer-option.correct { border-color:#4caf50; background:#e8f5e9; }
    .answer-option.incorrect { border-color:#f44336; background:#ffebee; }
    .answer-option.disabled { cursor: default; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // --- OpenAI gateway (sama og í „Sund“)
    async function callOpenAI(payload) {
      const r = await fetch('/.netlify/functions/openai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      const data = await r.json();
      if (!r.ok || data.error) throw new Error(data.error || `HTTP ${r.status}`);
      return data.content;
    }

    // --- Stilllingar
    const AUDIO_SRC = 'media/hlustun_latur.mp3';

    // --- Hlustunartexti (til viðmiðunar í kennslu – ekki sýndur nemanda)
    const SOURCE_TEXT = `
    Í vetur var Jónas mjög latur. Hann sat oft inni og horfði á sjónvarp eða var í tölvunni í stað þess að hreyfa sig.
    Hann fann stundum að hann var orðinn þreyttur þó hann gerði ekki mikið. Honum fannst hann líka orkulaus og hann svaf illa.
    Einn daginn ákvað hann að rífa sig upp og byrja að æfa aftur. Í fyrstu var það erfitt. Hann varð fljótt móður og fann fyrir verk í fótunum. En hann gafst ekki upp.
    Jónas byrjaði smátt. Hann fór út að ganga tvisvar í viku og reyndi að hjóla í vinnuna þegar veðrið var gott.
    Eftir nokkrar vikur fann hann að hann var orðinn sterkari og hafði meira þrek. Honum fór að líða betur og hann hafði meiri áhuga á að hreyfa sig reglulega.
    Núna fer hann stundum í ræktina eða í sund um helgar. Hann segir: „Ég þarf ekki að æfa á hverjum degi. Það mikilvægasta er að finna eitthvað sem mér finnst gaman að gera. Þegar ég hreyfi mig, sef ég betur, hef meiri orku og mér líður vel.“
    `;

    // --- 1) Rétt/rangt
    const TRUE_FALSE = [
      { statement: 'Jónas hreyfði sig mikið í vetur.', correct: false },
      { statement: 'Honum fannst hann oft þreyttur þó hann gerði lítið.', correct: true },
      { statement: 'Í byrjun varð hann fljótt móður þegar hann æfði.', correct: true },
      { statement: 'Jónas byrjaði á því að hlaupa maraþon.', correct: false },
      { statement: 'Eftir nokkrar vikur fékk hann meira þrek og meiri orku.', correct: true },
      { statement: 'Núna fer hann stundum í ræktina eða í sund um helgar.', correct: true }
    ];

    // --- 2) Krossar
    const MULTIPLE_CHOICE = [
      {
        question: 'Hvernig byrjaði Jónas að hreyfa sig?',
        options: ['Þungar lyftur daglega', 'Maraþon', 'Ganga og hjóla', 'Bara jóga'],
        correct: 2
      },
      {
        question: 'Hvað breyttist eftir nokkrar vikur?',
        options: ['Hann svaf verr', 'Hann hætti að hreyfa sig', 'Hann varð sterkari og fékk meira þrek', 'Hann var enn orkulaus'],
        correct: 2
      },
      {
        question: 'Hvað gerir hann stundum um helgar?',
        options: ['Fer í ræktina eða í sund', 'Fer aldrei út', 'Fer aðeins í sjósund', 'Fer á skíði'],
        correct: 0
      },
      {
        question: 'Hvað segir Jónas að sé mikilvægast?',
        options: ['Að æfa á hverjum degi', 'Að hlaupa hratt', 'Að finna eitthvað sem honum finnst gaman að gera', 'Að æfa alltaf einn'],
        correct: 2
      }
    ];

    // --- 3) Stuttar spurningar (AI endurgjöf)
    const SHORT_QUESTIONS = [
      {
        question: 'Af hverju ákvað Jónas að rífa sig upp og byrja að æfa?',
        expectedContent: ['þreyttur','orka','orkulaus','svaf illa','hreyfði sig lítið','líða betur']
      },
      {
        question: 'Hvaða tvær leiðir notaði hann fyrst til að hreyfa sig?',
        expectedContent: ['ganga','hjola','hjól','gengur','í vinnuna','tvisvar í viku'] // hjóla/hjól variations
      },
      {
        question: 'Hvað fann hann eftir nokkrar vikur?',
        expectedContent: ['sterkari','þrek','orka','líða betur','áhugi','reglulega']
      },
      {
        question: 'Hvað gerir hann stundum um helgar?',
        expectedContent: ['ræktin','sund','fer í ræktina','fer í sund']
      }
    ];

    // --- 4) Paraðu saman
    const MATCHING = [
      { left: 'þrek', right: 'úthald; getur hreyft sig lengur' },
      { left: 'ræktin', right: 'staður með tækjum til æfinga' },
      { left: 'að hreyfa sig reglulega', right: 'gera æfingar oft, með vana' },
      { left: 'að verða fljótt móður', right: 'þreytist hratt; mæðinn' }
    ];

    // --- Orðakassi
    const GLOSSARY = [
      { w: 'latur/löt', d: 'vill ekki gera mikið' },
      { w: 'að hreyfa sig', d: 'gera æfingar; ganga, hjóla, synda o.fl.' },
      { w: 'orkulaus', d: 'hefur litla orku' },
      { w: 'að rífa sig upp', d: 'byrja aftur; hætta að fresta' },
      { w: 'að verða fljótt móður', d: 'þreytist fljótt; mæðist' },
      { w: 'þrek (hk)', d: 'úthald; getur hreyft sig lengur' },
      { w: 'styrkur (kk)', d: 'kraftur í líkamanum' },
      { w: 'reglulega', d: 'oft, með vana (t.d. vikulega)' },
      { w: 'ræktin (kvk)', d: 'staður með tækjum til æfinga' },
      { w: 'sund (hk)', d: 'hreyfing í sundlaug' },
      { w: 'að líða betur', d: 'finna að manni er gott' }
    ];

    // --- Component
    const JonasRifurSigUpp = () => {
      const [playbackRate, setPlaybackRate] = useState(1);
      const [isPlaying, setIsPlaying] = useState(false);
      const audioRef = useRef(null);

      // States
      const [tfAnswers, setTfAnswers] = useState([]);
      const [tfChecked, setTfChecked] = useState(false);

      const [mcAnswers, setMcAnswers] = useState([]);
      const [mcChecked, setMcChecked] = useState(false);

      const [shortAnswers, setShortAnswers] = useState(Array(SHORT_QUESTIONS.length).fill(''));
      const [shortFeedback, setShortFeedback] = useState(Array(SHORT_QUESTIONS.length).fill(null));
      const [shortLoading, setShortLoading] = useState(Array(SHORT_QUESTIONS.length).fill(false));

      const [matchingAnswers, setMatchingAnswers] = useState(Array(MATCHING.length).fill(''));
      const [matchingChecked, setMatchingChecked] = useState(false);

      useEffect(() => {
        if (audioRef.current) audioRef.current.playbackRate = playbackRate;
      }, [playbackRate]);

      const togglePlay = () => {
        if (!audioRef.current) return;
        if (isPlaying) audioRef.current.pause(); else audioRef.current.play();
        setIsPlaying(!isPlaying);
      };

      // TRUE/FALSE
      const handleTfAnswer = (index, answer) => {
        if (tfChecked) return;
        const next = [...tfAnswers];
        next[index] = answer;
        setTfAnswers(next);
      };
      const checkTfAnswers = () => {
        if (tfAnswers.length < TRUE_FALSE.length) { alert('Vinsamlegast svaraðu öllum spurningum!'); return; }
        setTfChecked(true);
      };

      // MCQ
      const handleMcAnswer = (qIndex, optIndex) => {
        if (mcChecked) return;
        const next = [...mcAnswers]; next[qIndex] = optIndex; setMcAnswers(next);
      };
      const checkMcAnswers = () => {
        if (mcAnswers.length < MULTIPLE_CHOICE.length) { alert('Vinsamlegast svaraðu öllum spurningum!'); return; }
        setMcChecked(true);
      };

      // Short answers with AI feedback
      const handleShortAnswer = (index, value) => {
        const next = [...shortAnswers]; next[index] = value; setShortAnswers(next);
      };
      const checkShortAnswer = async (index) => {
        if (shortAnswers[index].trim().length < 3) { alert('Vinsamlegast skrifaðu svar!'); return; }

        // valkvætt: geyma (disabled á meðan engin Supabase)
        const newLoading = [...shortLoading]; newLoading[index] = true; setShortLoading(newLoading);

        try {
          const question = SHORT_QUESTIONS[index];
          const userAnswer = shortAnswers[index];

          const sys = `Þú ert íslenskukennari sem metur stutt svör nemenda út frá hlustunartexta.
TEXTI (til viðmiðunar, ekki svara honum aftur):
${SOURCE_TEXT}

SPURNING:
"${question.question}"

SVAR NEMANDA:
"${userAnswer}"

LYKILATRIÐI SEM EIGA AÐ KOMA FRAM:
${question.expectedContent.join(', ')}

VERKEFNI:
1) Meta hvort svarið nær kjarnanum (innihald), hunsa smávægilegar mál- og stafsetningarvillur.
2) Skila stuttri, hvetjandi endurgjöf á íslensku.

SKILAÐU NÁKVÆMLEGA JSON (ENGIN TEXTASKÝRING AUKALEGA):
{
  "correct": boolean,
  "feedback": "stutt hvetjandi endurgjöf á íslensku"
}`;
          const response = await callOpenAI({
            model: 'gpt-4o',
            temperature: 0.3,
            max_tokens: 200,
            messages: [
              { role: 'system', content: sys },
              { role: 'user', content: 'Meta svar' }
            ]
          });

          // örugg JSON-tiltekt
          let clean = response
            .replace(/```json\s*/g, '')
            .replace(/```\s*/g, '')
            .trim();
          const firstBrace = clean.indexOf('{');
          const lastBrace = clean.lastIndexOf('}');
          if (firstBrace >= 0 && lastBrace >= firstBrace) {
            clean = clean.slice(firstBrace, lastBrace + 1);
          }
          const data = JSON.parse(clean);

          const nf = [...shortFeedback]; nf[index] = data; setShortFeedback(nf);
        } catch (e) {
          console.error(e);
          alert('Villa við að meta svar. Reyndu aftur.');
        } finally {
          const nl = [...shortLoading]; nl[index] = false; setShortLoading(nl);
        }
      };

      // Matching
      const handleMatchingAnswer = (index, value) => {
        if (matchingChecked) return;
        const next = [...matchingAnswers]; next[index] = value; setMatchingAnswers(next);
      };
      const isMatchingCorrect = (index) => matchingAnswers[index] === MATCHING[index].right;
      const checkMatching = () => {
        if (matchingAnswers.some(a => !a)) { alert('Vinsamlegast svaraðu öllum spurningum!'); return; }
        setMatchingChecked(true);
      };

      // UI
      const rightOptions = MATCHING.map(m => m.right).sort(() => Math.random() - 0.5);

      return (
        <div className="min-h-screen pb-12">
          {/* Haus */}
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-4xl mx-auto px-6 py-8">
              <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">
                ← Til baka
              </button>
              <h1 className="text-3xl font-light text-gray-800 mb-2">Hlustun: Jónas rífur sig upp</h1>
              <p className="text-gray-500 text-sm font-light">Hlustunarverkefni · A1–A2</p>
            </div>
          </header>

          {/* Sticky Audio Player */}
          <div className="sticky-player">
            <div className="max-w-4xl mx-auto px-6 py-4">
              <div className="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border-2 border-blue-200">
                <div className="flex items-center gap-4">
                  <button
                    onClick={togglePlay}
                    className="bg-blue-500 text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors flex-shrink-0"
                    aria-label={isPlaying ? 'Pása' : 'Spila'}
                  >
                    {isPlaying ? (
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16" /><rect x="14" y="4" width="4" height="16" /></svg>
                    ) : (
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3" /></svg>
                    )}
                  </button>

                  <div className="flex-1">
                    <p className="text-sm font-normal text-gray-800 mb-1">🎧 Hlusta á textann</p>
                    <audio
                      ref={audioRef}
                      src={AUDIO_SRC}
                      preload="none"
                      onEnded={() => setIsPlaying(false)}
                      onPlay={() => setIsPlaying(true)}
                      onPause={() => setIsPlaying(false)}
                    />
                  </div>

                  <div className="flex gap-2">
                    <button onClick={() => setPlaybackRate(0.75)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 0.75 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>0.75×</button>
                    <button onClick={() => setPlaybackRate(1)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 1 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>1×</button>
                    <button onClick={() => setPlaybackRate(1.25)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 1.25 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>1.25×</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <main className="max-w-4xl mx-auto px-6 mt-8 space-y-8">
            {/* Leiðbeiningar */}
            <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
              <h2 className="text-xl font-normal text-gray-800 mb-3">📝 Leiðbeiningar</h2>
              <ul className="space-y-2 text-gray-700 font-light">
                <li>• Hlustaðu á textann 2–3 sinnum</li>
                <li>• Þú getur hægt eða hraðað á hljóðinu</li>
                <li>• Svaraðu spurningunum hér að neðan</li>
                <li>• Þú mátt hlusta eins oft og þú vilt</li>
              </ul>
            </div>

            {/* 1. Rétt eða rangt */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">1️⃣ Rétt eða rangt?</h2>
              <div className="space-y-4">
                {TRUE_FALSE.map((item, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-light text-gray-800 mb-3">{item.statement}</p>
                    <div className="flex gap-4">
                      {[true, false].map((answer) => {
                        const isSelected = tfAnswers[index] === answer;
                        const isCorrect = answer === item.correct;
                        const showAsCorrect = tfChecked && isCorrect;
                        const showAsIncorrect = tfChecked && isSelected && !isCorrect;

                        return (
                          <div
                            key={answer ? 'true' : 'false'}
                            onClick={() => handleTfAnswer(index, answer)}
                            className={`answer-option flex-1 p-3 rounded-lg ${
                              isSelected && !tfChecked ? 'selected' : ''
                            } ${showAsCorrect ? 'correct' : ''} ${showAsIncorrect ? 'incorrect' : ''} ${
                              tfChecked ? 'disabled' : ''
                            }`}
                          >
                            <div className="flex items-center justify-center gap-2">
                              <div className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${
                                isSelected && !tfChecked ? 'border-blue-500 bg-blue-500' :
                                showAsCorrect ? 'border-green-500 bg-green-500' :
                                showAsIncorrect ? 'border-red-500 bg-red-500' : 'border-gray-300'
                              }`}>
                                {(isSelected || showAsCorrect) && (<div className="w-1.5 h-1.5 bg-white rounded-full"></div>)}
                              </div>
                              <span className="font-light text-sm">{answer ? 'Rétt' : 'Rangt'}</span>
                              {showAsCorrect && <span className="text-green-600">✓</span>}
                              {showAsIncorrect && <span className="text-red-600">✗</span>}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
              {!tfChecked ? (
                <button onClick={checkTfAnswers} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga svör
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ✓ Þú fékkst {tfAnswers.filter((a, i) => a === TRUE_FALSE[i].correct).length} af {TRUE_FALSE.length} rétt!
                  </p>
                </div>
              )}
            </section>

            {/* 2. Krossaspurningar */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">2️⃣ Krossaspurningar</h2>
              <div className="space-y-6">
                {MULTIPLE_CHOICE.map((q, qIndex) => (
                  <div key={qIndex} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-normal text-gray-800 mb-4">{q.question}</p>
                    <div className="space-y-2">
                      {q.options.map((option, oIndex) => {
                        const isSelected = mcAnswers[qIndex] === oIndex;
                        const isCorrect = oIndex === q.correct;
                        const showAsCorrect = mcChecked && isCorrect;
                        const showAsIncorrect = mcChecked && isSelected && !isCorrect;

                        return (
                          <div
                            key={oIndex}
                            onClick={() => handleMcAnswer(qIndex, oIndex)}
                            className={`answer-option p-3 rounded-lg ${
                              isSelected && !mcChecked ? 'selected' : ''
                            } ${showAsCorrect ? 'correct' : ''} ${showAsIncorrect ? 'incorrect' : ''} ${
                              mcChecked ? 'disabled' : ''
                            }`}
                          >
                            <div className="flex items-center gap-3">
                              <div className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${
                                isSelected && !mcChecked ? 'border-blue-500 bg-blue-500' :
                                showAsCorrect ? 'border-green-500 bg-green-500' :
                                showAsIncorrect ? 'border-red-500 bg-red-500' : 'border-gray-300'
                              }`}>
                                {(isSelected || showAsCorrect) && (<div className="w-1.5 h-1.5 bg-white rounded-full"></div>)}
                              </div>
                              <span className="font-light flex-1">{option}</span>
                              {showAsCorrect && <span className="text-green-600">✓</span>}
                              {showAsIncorrect && <span className="text-red-600">✗</span>}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
              {!mcChecked ? (
                <button onClick={checkMcAnswers} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga svör
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ✓ Þú fékkst {mcAnswers.filter((a, i) => a === MULTIPLE_CHOICE[i].correct).length} af {MULTIPLE_CHOICE.length} rétt!
                  </p>
                </div>
              )}
            </section>

            {/* 3. Stuttar spurningar (AI) */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">3️⃣ Stuttar spurningar</h2>
              <p className="text-gray-600 font-light mb-6">Svaraðu spurningunum með þínum eigin orðum.</p>
              <div className="space-y-6">
                {SHORT_QUESTIONS.map((q, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-normal text-gray-800 mb-3">{index + 1}. {q.question}</p>
                    <textarea
                      value={shortAnswers[index]}
                      onChange={(e) => handleShortAnswer(index, e.target.value)}
                      disabled={shortFeedback[index] !== null}
                      className="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 font-light"
                      rows="3"
                      placeholder="Skrifaðu svarið þitt hér..."
                    />
                    {!shortFeedback[index] ? (
                      <button
                        onClick={() => checkShortAnswer(index)}
                        disabled={shortLoading[index]}
                        className="mt-3 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:bg-gray-300 transition-colors font-light text-sm"
                      >
                        {shortLoading[index] ? 'Athuga...' : 'Athuga svar'}
                      </button>
                    ) : (
                      <div className={`mt-3 p-3 rounded-lg ${
                        shortFeedback[index].correct ? 'bg-green-50 border-2 border-green-200' : 'bg-yellow-50 border-2 border-yellow-200'
                      }`}>
                        <p className={`text-sm font-light ${
                          shortFeedback[index].correct ? 'text-green-800' : 'text-yellow-800'
                        }`}>
                          {shortFeedback[index].correct ? '✓' : '💡'} {shortFeedback[index].feedback}
                        </p>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </section>

            {/* 4. Paraðu saman */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">4️⃣ Paraðu saman</h2>
              <div className="space-y-4">
                {MATCHING.map((item, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <div className="flex items-center gap-4">
                      <div className="flex-1"><span className="font-normal text-gray-800">{item.left}</span></div>
                      <div className="text-gray-400">→</div>
                      <div className="flex-1">
                        <select
                          value={matchingAnswers[index]}
                          onChange={(e) => handleMatchingAnswer(index, e.target.value)}
                          disabled={matchingChecked}
                          className={`w-full p-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 font-light ${
                            matchingChecked
                              ? (matchingAnswers[index]===item.right ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50')
                              : 'border-gray-300'
                          }`}
                        >
                          <option value="">Veldu...</option>
                          {rightOptions.map((opt, i) => (<option key={i} value={opt}>{opt}</option>))}
                        </select>
                      </div>
                      {matchingChecked && (<div className="w-8">{matchingAnswers[index]===item.right ? <span className="text-green-600 text-xl">✓</span> : <span className="text-red-600 text-xl">✗</span>}</div>)}
                    </div>
                    {matchingChecked && matchingAnswers[index]!==item.right && (
                      <p className="text-sm text-red-600 mt-2">✗ Rétt svar: {item.right}</p>
                    )}
                  </div>
                ))}
              </div>
              {!matchingChecked ? (
                <button onClick={checkMatching} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga svör
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ✓ Þú fékkst {matchingAnswers.filter((v,i)=>v===MATCHING[i].right).length} af {MATCHING.length} rétt!
                  </p>
                </div>
              )}
            </section>

            {/* Orðakassi */}
            <section className="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-4">📘 Lykilorð úr hlustun</h2>
              <p className="text-gray-700 font-light mb-4">Lestu yfir orðin og reyndu að finna þau aftur í hlustuninni.</p>
              <div className="grid md:grid-cols-2 gap-3">
                {GLOSSARY.map((it, i) => (
                  <div key={i} className="rounded-lg border-2 border-yellow-200 bg-white/70 p-3">
                    <div className="font-normal text-gray-900">{it.w}</div>
                    <div className="text-sm text-gray-600 font-light">{it.d}</div>
                  </div>
                ))}
              </div>
            </section>

          </main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<JonasRifurSigUpp />);
  </script>
</body>
</html>
