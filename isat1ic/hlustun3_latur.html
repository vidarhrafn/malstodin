<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üéß Hlustun: J√≥nas r√≠fur sig upp ‚Äì M√°lst√∂√∞in</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Ef √æ√∫ ert me√∞ notandauth eins og √°√∞ur -->
  <script src="/isat1ic/auth.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    .sticky-player { position: sticky; top: 0; z-index: 50; background: white; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .answer-option { border: 2px solid #e0e0e0; transition: all 0.2s; cursor: pointer; }
    .answer-option:hover:not(.disabled) { border-color:#2196f3; background:#e3f2fd; }
    .answer-option.selected { border-color:#2196f3; background:#e3f2fd; }
    .answer-option.correct { border-color:#4caf50; background:#e8f5e9; }
    .answer-option.incorrect { border-color:#f44336; background:#ffebee; }
    .answer-option.disabled { cursor: default; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // --- OpenAI gateway (sama og √≠ ‚ÄûSund‚Äú)
    async function callOpenAI(payload) {
      const r = await fetch('/.netlify/functions/openai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      const data = await r.json();
      if (!r.ok || data.error) throw new Error(data.error || `HTTP ${r.status}`);
      return data.content;
    }

    // --- Stilllingar
    const AUDIO_SRC = 'media/hlustun_latur.mp3';

    // --- Hlustunartexti (til vi√∞mi√∞unar √≠ kennslu ‚Äì ekki s√Ωndur nemanda)
    const SOURCE_TEXT = `
    √ç vetur var J√≥nas mj√∂g latur. Hann sat oft inni og horf√∞i √° sj√≥nvarp e√∞a var √≠ t√∂lvunni √≠ sta√∞ √æess a√∞ hreyfa sig.
    Hann fann stundum a√∞ hann var or√∞inn √æreyttur √æ√≥ hann ger√∞i ekki miki√∞. Honum fannst hann l√≠ka orkulaus og hann svaf illa.
    Einn daginn √°kva√∞ hann a√∞ r√≠fa sig upp og byrja a√∞ √¶fa aftur. √ç fyrstu var √æa√∞ erfitt. Hann var√∞ flj√≥tt m√≥√∞ur og fann fyrir verk √≠ f√≥tunum. En hann gafst ekki upp.
    J√≥nas byrja√∞i sm√°tt. Hann f√≥r √∫t a√∞ ganga tvisvar √≠ viku og reyndi a√∞ hj√≥la √≠ vinnuna √æegar ve√∞ri√∞ var gott.
    Eftir nokkrar vikur fann hann a√∞ hann var or√∞inn sterkari og haf√∞i meira √ærek. Honum f√≥r a√∞ l√≠√∞a betur og hann haf√∞i meiri √°huga √° a√∞ hreyfa sig reglulega.
    N√∫na fer hann stundum √≠ r√¶ktina e√∞a √≠ sund um helgar. Hann segir: ‚Äû√âg √æarf ekki a√∞ √¶fa √° hverjum degi. √ûa√∞ mikilv√¶gasta er a√∞ finna eitthva√∞ sem m√©r finnst gaman a√∞ gera. √ûegar √©g hreyfi mig, sef √©g betur, hef meiri orku og m√©r l√≠√∞ur vel.‚Äú
    `;

    // --- 1) R√©tt/rangt
    const TRUE_FALSE = [
      { statement: 'J√≥nas hreyf√∞i sig miki√∞ √≠ vetur.', correct: false },
      { statement: 'Honum fannst hann oft √æreyttur √æ√≥ hann ger√∞i l√≠ti√∞.', correct: true },
      { statement: '√ç byrjun var√∞ hann flj√≥tt m√≥√∞ur √æegar hann √¶f√∞i.', correct: true },
      { statement: 'J√≥nas byrja√∞i √° √æv√≠ a√∞ hlaupa mara√æon.', correct: false },
      { statement: 'Eftir nokkrar vikur f√©kk hann meira √ærek og meiri orku.', correct: true },
      { statement: 'N√∫na fer hann stundum √≠ r√¶ktina e√∞a √≠ sund um helgar.', correct: true }
    ];

    // --- 2) Krossar
    const MULTIPLE_CHOICE = [
      {
        question: 'Hvernig byrja√∞i J√≥nas a√∞ hreyfa sig?',
        options: ['√ûungar lyftur daglega', 'Mara√æon', 'Ganga og hj√≥la', 'Bara j√≥ga'],
        correct: 2
      },
      {
        question: 'Hva√∞ breyttist eftir nokkrar vikur?',
        options: ['Hann svaf verr', 'Hann h√¶tti a√∞ hreyfa sig', 'Hann var√∞ sterkari og f√©kk meira √ærek', 'Hann var enn orkulaus'],
        correct: 2
      },
      {
        question: 'Hva√∞ gerir hann stundum um helgar?',
        options: ['Fer √≠ r√¶ktina e√∞a √≠ sund', 'Fer aldrei √∫t', 'Fer a√∞eins √≠ sj√≥sund', 'Fer √° sk√≠√∞i'],
        correct: 0
      },
      {
        question: 'Hva√∞ segir J√≥nas a√∞ s√© mikilv√¶gast?',
        options: ['A√∞ √¶fa √° hverjum degi', 'A√∞ hlaupa hratt', 'A√∞ finna eitthva√∞ sem honum finnst gaman a√∞ gera', 'A√∞ √¶fa alltaf einn'],
        correct: 2
      }
    ];

    // --- 3) Stuttar spurningar (AI endurgj√∂f)
    const SHORT_QUESTIONS = [
      {
        question: 'Af hverju √°kva√∞ J√≥nas a√∞ r√≠fa sig upp og byrja a√∞ √¶fa?',
        expectedContent: ['√æreyttur','orka','orkulaus','svaf illa','hreyf√∞i sig l√≠ti√∞','l√≠√∞a betur']
      },
      {
        question: 'Hva√∞a tv√¶r lei√∞ir nota√∞i hann fyrst til a√∞ hreyfa sig?',
        expectedContent: ['ganga','hjola','hj√≥l','gengur','√≠ vinnuna','tvisvar √≠ viku'] // hj√≥la/hj√≥l variations
      },
      {
        question: 'Hva√∞ fann hann eftir nokkrar vikur?',
        expectedContent: ['sterkari','√ærek','orka','l√≠√∞a betur','√°hugi','reglulega']
      },
      {
        question: 'Hva√∞ gerir hann stundum um helgar?',
        expectedContent: ['r√¶ktin','sund','fer √≠ r√¶ktina','fer √≠ sund']
      }
    ];

    // --- 4) Para√∞u saman
    const MATCHING = [
      { left: '√ærek', right: '√∫thald; getur hreyft sig lengur' },
      { left: 'r√¶ktin', right: 'sta√∞ur me√∞ t√¶kjum til √¶finga' },
      { left: 'a√∞ hreyfa sig reglulega', right: 'gera √¶fingar oft, me√∞ vana' },
      { left: 'a√∞ ver√∞a flj√≥tt m√≥√∞ur', right: '√æreytist hratt; m√¶√∞inn' }
    ];

    // --- Or√∞akassi
    const GLOSSARY = [
      { w: 'latur/l√∂t', d: 'vill ekki gera miki√∞' },
      { w: 'a√∞ hreyfa sig', d: 'gera √¶fingar; ganga, hj√≥la, synda o.fl.' },
      { w: 'orkulaus', d: 'hefur litla orku' },
      { w: 'a√∞ r√≠fa sig upp', d: 'byrja aftur; h√¶tta a√∞ fresta' },
      { w: 'a√∞ ver√∞a flj√≥tt m√≥√∞ur', d: '√æreytist flj√≥tt; m√¶√∞ist' },
      { w: '√ærek (hk)', d: '√∫thald; getur hreyft sig lengur' },
      { w: 'styrkur (kk)', d: 'kraftur √≠ l√≠kamanum' },
      { w: 'reglulega', d: 'oft, me√∞ vana (t.d. vikulega)' },
      { w: 'r√¶ktin (kvk)', d: 'sta√∞ur me√∞ t√¶kjum til √¶finga' },
      { w: 'sund (hk)', d: 'hreyfing √≠ sundlaug' },
      { w: 'a√∞ l√≠√∞a betur', d: 'finna a√∞ manni er gott' }
    ];

    // --- Component
    const JonasRifurSigUpp = () => {
      const [playbackRate, setPlaybackRate] = useState(1);
      const [isPlaying, setIsPlaying] = useState(false);
      const audioRef = useRef(null);

      // States
      const [tfAnswers, setTfAnswers] = useState([]);
      const [tfChecked, setTfChecked] = useState(false);

      const [mcAnswers, setMcAnswers] = useState([]);
      const [mcChecked, setMcChecked] = useState(false);

      const [shortAnswers, setShortAnswers] = useState(Array(SHORT_QUESTIONS.length).fill(''));
      const [shortFeedback, setShortFeedback] = useState(Array(SHORT_QUESTIONS.length).fill(null));
      const [shortLoading, setShortLoading] = useState(Array(SHORT_QUESTIONS.length).fill(false));

      const [matchingAnswers, setMatchingAnswers] = useState(Array(MATCHING.length).fill(''));
      const [matchingChecked, setMatchingChecked] = useState(false);

      useEffect(() => {
        if (audioRef.current) audioRef.current.playbackRate = playbackRate;
      }, [playbackRate]);

      const togglePlay = () => {
        if (!audioRef.current) return;
        if (isPlaying) audioRef.current.pause(); else audioRef.current.play();
        setIsPlaying(!isPlaying);
      };

      // TRUE/FALSE
      const handleTfAnswer = (index, answer) => {
        if (tfChecked) return;
        const next = [...tfAnswers];
        next[index] = answer;
        setTfAnswers(next);
      };
      const checkTfAnswers = () => {
        if (tfAnswers.length < TRUE_FALSE.length) { alert('Vinsamlegast svara√∞u √∂llum spurningum!'); return; }
        setTfChecked(true);
      };

      // MCQ
      const handleMcAnswer = (qIndex, optIndex) => {
        if (mcChecked) return;
        const next = [...mcAnswers]; next[qIndex] = optIndex; setMcAnswers(next);
      };
      const checkMcAnswers = () => {
        if (mcAnswers.length < MULTIPLE_CHOICE.length) { alert('Vinsamlegast svara√∞u √∂llum spurningum!'); return; }
        setMcChecked(true);
      };

      // Short answers with AI feedback
      const handleShortAnswer = (index, value) => {
        const next = [...shortAnswers]; next[index] = value; setShortAnswers(next);
      };
      const checkShortAnswer = async (index) => {
        if (shortAnswers[index].trim().length < 3) { alert('Vinsamlegast skrifa√∞u svar!'); return; }

        // valkv√¶tt: geyma (disabled √° me√∞an engin Supabase)
        const newLoading = [...shortLoading]; newLoading[index] = true; setShortLoading(newLoading);

        try {
          const question = SHORT_QUESTIONS[index];
          const userAnswer = shortAnswers[index];

          const sys = `√û√∫ ert √≠slenskukennari sem metur stutt sv√∂r nemenda √∫t fr√° hlustunartexta.
TEXTI (til vi√∞mi√∞unar, ekki svara honum aftur):
${SOURCE_TEXT}

SPURNING:
"${question.question}"

SVAR NEMANDA:
"${userAnswer}"

LYKILATRI√êI SEM EIGA A√ê KOMA FRAM:
${question.expectedContent.join(', ')}

VERKEFNI:
1) Meta hvort svari√∞ n√¶r kjarnanum (innihald), hunsa sm√°v√¶gilegar m√°l- og stafsetningarvillur.
2) Skila stuttri, hvetjandi endurgj√∂f √° √≠slensku.

SKILA√êU N√ÅKV√ÜMLEGA JSON (ENGIN TEXTASK√ùRING AUKALEGA):
{
  "correct": boolean,
  "feedback": "stutt hvetjandi endurgj√∂f √° √≠slensku"
}`;
          const response = await callOpenAI({
            model: 'gpt-4o',
            temperature: 0.3,
            max_tokens: 200,
            messages: [
              { role: 'system', content: sys },
              { role: 'user', content: 'Meta svar' }
            ]
          });

          // √∂rugg JSON-tiltekt
          let clean = response
            .replace(/```json\s*/g, '')
            .replace(/```\s*/g, '')
            .trim();
          const firstBrace = clean.indexOf('{');
          const lastBrace = clean.lastIndexOf('}');
          if (firstBrace >= 0 && lastBrace >= firstBrace) {
            clean = clean.slice(firstBrace, lastBrace + 1);
          }
          const data = JSON.parse(clean);

          const nf = [...shortFeedback]; nf[index] = data; setShortFeedback(nf);
        } catch (e) {
          console.error(e);
          alert('Villa vi√∞ a√∞ meta svar. Reyndu aftur.');
        } finally {
          const nl = [...shortLoading]; nl[index] = false; setShortLoading(nl);
        }
      };

      // Matching
      const handleMatchingAnswer = (index, value) => {
        if (matchingChecked) return;
        const next = [...matchingAnswers]; next[index] = value; setMatchingAnswers(next);
      };
      const isMatchingCorrect = (index) => matchingAnswers[index] === MATCHING[index].right;
      const checkMatching = () => {
        if (matchingAnswers.some(a => !a)) { alert('Vinsamlegast svara√∞u √∂llum spurningum!'); return; }
        setMatchingChecked(true);
      };

      // UI
      const rightOptions = MATCHING.map(m => m.right).sort(() => Math.random() - 0.5);

      return (
        <div className="min-h-screen pb-12">
          {/* Haus */}
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-4xl mx-auto px-6 py-8">
              <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">
                ‚Üê Til baka
              </button>
              <h1 className="text-3xl font-light text-gray-800 mb-2">Hlustun: J√≥nas r√≠fur sig upp</h1>
              <p className="text-gray-500 text-sm font-light">Hlustunarverkefni ¬∑ A1‚ÄìA2</p>
            </div>
          </header>

          {/* Sticky Audio Player */}
          <div className="sticky-player">
            <div className="max-w-4xl mx-auto px-6 py-4">
              <div className="bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border-2 border-blue-200">
                <div className="flex items-center gap-4">
                  <button
                    onClick={togglePlay}
                    className="bg-blue-500 text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors flex-shrink-0"
                    aria-label={isPlaying ? 'P√°sa' : 'Spila'}
                  >
                    {isPlaying ? (
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16" /><rect x="14" y="4" width="4" height="16" /></svg>
                    ) : (
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3" /></svg>
                    )}
                  </button>

                  <div className="flex-1">
                    <p className="text-sm font-normal text-gray-800 mb-1">üéß Hlusta √° textann</p>
                    <audio
                      ref={audioRef}
                      src={AUDIO_SRC}
                      preload="none"
                      onEnded={() => setIsPlaying(false)}
                      onPlay={() => setIsPlaying(true)}
                      onPause={() => setIsPlaying(false)}
                    />
                  </div>

                  <div className="flex gap-2">
                    <button onClick={() => setPlaybackRate(0.75)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 0.75 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>0.75√ó</button>
                    <button onClick={() => setPlaybackRate(1)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 1 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>1√ó</button>
                    <button onClick={() => setPlaybackRate(1.25)} className={`px-3 py-1 rounded-md text-sm font-light transition-colors ${playbackRate === 1.25 ? 'bg-blue-500 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>1.25√ó</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <main className="max-w-4xl mx-auto px-6 mt-8 space-y-8">
            {/* Lei√∞beiningar */}
            <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
              <h2 className="text-xl font-normal text-gray-800 mb-3">üìù Lei√∞beiningar</h2>
              <ul className="space-y-2 text-gray-700 font-light">
                <li>‚Ä¢ Hlusta√∞u √° textann 2‚Äì3 sinnum</li>
                <li>‚Ä¢ √û√∫ getur h√¶gt e√∞a hra√∞a√∞ √° hlj√≥√∞inu</li>
                <li>‚Ä¢ Svara√∞u spurningunum h√©r a√∞ ne√∞an</li>
                <li>‚Ä¢ √û√∫ m√°tt hlusta eins oft og √æ√∫ vilt</li>
              </ul>
            </div>

            {/* 1. R√©tt e√∞a rangt */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">1Ô∏è‚É£ R√©tt e√∞a rangt?</h2>
              <div className="space-y-4">
                {TRUE_FALSE.map((item, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-light text-gray-800 mb-3">{item.statement}</p>
                    <div className="flex gap-4">
                      {[true, false].map((answer) => {
                        const isSelected = tfAnswers[index] === answer;
                        const isCorrect = answer === item.correct;
                        const showAsCorrect = tfChecked && isCorrect;
                        const showAsIncorrect = tfChecked && isSelected && !isCorrect;

                        return (
                          <div
                            key={answer ? 'true' : 'false'}
                            onClick={() => handleTfAnswer(index, answer)}
                            className={`answer-option flex-1 p-3 rounded-lg ${
                              isSelected && !tfChecked ? 'selected' : ''
                            } ${showAsCorrect ? 'correct' : ''} ${showAsIncorrect ? 'incorrect' : ''} ${
                              tfChecked ? 'disabled' : ''
                            }`}
                          >
                            <div className="flex items-center justify-center gap-2">
                              <div className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${
                                isSelected && !tfChecked ? 'border-blue-500 bg-blue-500' :
                                showAsCorrect ? 'border-green-500 bg-green-500' :
                                showAsIncorrect ? 'border-red-500 bg-red-500' : 'border-gray-300'
                              }`}>
                                {(isSelected || showAsCorrect) && (<div className="w-1.5 h-1.5 bg-white rounded-full"></div>)}
                              </div>
                              <span className="font-light text-sm">{answer ? 'R√©tt' : 'Rangt'}</span>
                              {showAsCorrect && <span className="text-green-600">‚úì</span>}
                              {showAsIncorrect && <span className="text-red-600">‚úó</span>}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
              {!tfChecked ? (
                <button onClick={checkTfAnswers} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga sv√∂r
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ‚úì √û√∫ f√©kkst {tfAnswers.filter((a, i) => a === TRUE_FALSE[i].correct).length} af {TRUE_FALSE.length} r√©tt!
                  </p>
                </div>
              )}
            </section>

            {/* 2. Krossaspurningar */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">2Ô∏è‚É£ Krossaspurningar</h2>
              <div className="space-y-6">
                {MULTIPLE_CHOICE.map((q, qIndex) => (
                  <div key={qIndex} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-normal text-gray-800 mb-4">{q.question}</p>
                    <div className="space-y-2">
                      {q.options.map((option, oIndex) => {
                        const isSelected = mcAnswers[qIndex] === oIndex;
                        const isCorrect = oIndex === q.correct;
                        const showAsCorrect = mcChecked && isCorrect;
                        const showAsIncorrect = mcChecked && isSelected && !isCorrect;

                        return (
                          <div
                            key={oIndex}
                            onClick={() => handleMcAnswer(qIndex, oIndex)}
                            className={`answer-option p-3 rounded-lg ${
                              isSelected && !mcChecked ? 'selected' : ''
                            } ${showAsCorrect ? 'correct' : ''} ${showAsIncorrect ? 'incorrect' : ''} ${
                              mcChecked ? 'disabled' : ''
                            }`}
                          >
                            <div className="flex items-center gap-3">
                              <div className={`w-4 h-4 rounded-full border-2 flex items-center justify-center ${
                                isSelected && !mcChecked ? 'border-blue-500 bg-blue-500' :
                                showAsCorrect ? 'border-green-500 bg-green-500' :
                                showAsIncorrect ? 'border-red-500 bg-red-500' : 'border-gray-300'
                              }`}>
                                {(isSelected || showAsCorrect) && (<div className="w-1.5 h-1.5 bg-white rounded-full"></div>)}
                              </div>
                              <span className="font-light flex-1">{option}</span>
                              {showAsCorrect && <span className="text-green-600">‚úì</span>}
                              {showAsIncorrect && <span className="text-red-600">‚úó</span>}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
              {!mcChecked ? (
                <button onClick={checkMcAnswers} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga sv√∂r
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ‚úì √û√∫ f√©kkst {mcAnswers.filter((a, i) => a === MULTIPLE_CHOICE[i].correct).length} af {MULTIPLE_CHOICE.length} r√©tt!
                  </p>
                </div>
              )}
            </section>

            {/* 3. Stuttar spurningar (AI) */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">3Ô∏è‚É£ Stuttar spurningar</h2>
              <p className="text-gray-600 font-light mb-6">Svara√∞u spurningunum me√∞ √æ√≠num eigin or√∞um.</p>
              <div className="space-y-6">
                {SHORT_QUESTIONS.map((q, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <p className="font-normal text-gray-800 mb-3">{index + 1}. {q.question}</p>
                    <textarea
                      value={shortAnswers[index]}
                      onChange={(e) => handleShortAnswer(index, e.target.value)}
                      disabled={shortFeedback[index] !== null}
                      className="w-full p-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 font-light"
                      rows="3"
                      placeholder="Skrifa√∞u svari√∞ √æitt h√©r..."
                    />
                    {!shortFeedback[index] ? (
                      <button
                        onClick={() => checkShortAnswer(index)}
                        disabled={shortLoading[index]}
                        className="mt-3 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:bg-gray-300 transition-colors font-light text-sm"
                      >
                        {shortLoading[index] ? 'Athuga...' : 'Athuga svar'}
                      </button>
                    ) : (
                      <div className={`mt-3 p-3 rounded-lg ${
                        shortFeedback[index].correct ? 'bg-green-50 border-2 border-green-200' : 'bg-yellow-50 border-2 border-yellow-200'
                      }`}>
                        <p className={`text-sm font-light ${
                          shortFeedback[index].correct ? 'text-green-800' : 'text-yellow-800'
                        }`}>
                          {shortFeedback[index].correct ? '‚úì' : 'üí°'} {shortFeedback[index].feedback}
                        </p>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </section>

            {/* 4. Para√∞u saman */}
            <section className="bg-white rounded-lg shadow-sm p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-6">4Ô∏è‚É£ Para√∞u saman</h2>
              <div className="space-y-4">
                {MATCHING.map((item, index) => (
                  <div key={index} className="border-2 border-gray-100 rounded-lg p-4">
                    <div className="flex items-center gap-4">
                      <div className="flex-1"><span className="font-normal text-gray-800">{item.left}</span></div>
                      <div className="text-gray-400">‚Üí</div>
                      <div className="flex-1">
                        <select
                          value={matchingAnswers[index]}
                          onChange={(e) => handleMatchingAnswer(index, e.target.value)}
                          disabled={matchingChecked}
                          className={`w-full p-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 font-light ${
                            matchingChecked
                              ? (matchingAnswers[index]===item.right ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50')
                              : 'border-gray-300'
                          }`}
                        >
                          <option value="">Veldu...</option>
                          {rightOptions.map((opt, i) => (<option key={i} value={opt}>{opt}</option>))}
                        </select>
                      </div>
                      {matchingChecked && (<div className="w-8">{matchingAnswers[index]===item.right ? <span className="text-green-600 text-xl">‚úì</span> : <span className="text-red-600 text-xl">‚úó</span>}</div>)}
                    </div>
                    {matchingChecked && matchingAnswers[index]!==item.right && (
                      <p className="text-sm text-red-600 mt-2">‚úó R√©tt svar: {item.right}</p>
                    )}
                  </div>
                ))}
              </div>
              {!matchingChecked ? (
                <button onClick={checkMatching} className="mt-6 bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors font-light">
                  Athuga sv√∂r
                </button>
              ) : (
                <div className="mt-6 bg-green-50 border-2 border-green-200 rounded-lg p-4">
                  <p className="text-green-800 font-light">
                    ‚úì √û√∫ f√©kkst {matchingAnswers.filter((v,i)=>v===MATCHING[i].right).length} af {MATCHING.length} r√©tt!
                  </p>
                </div>
              )}
            </section>

            {/* Or√∞akassi */}
            <section className="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-8">
              <h2 className="text-2xl font-light text-gray-800 mb-4">üìò Lykilor√∞ √∫r hlustun</h2>
              <p className="text-gray-700 font-light mb-4">Lestu yfir or√∞in og reyndu a√∞ finna √æau aftur √≠ hlustuninni.</p>
              <div className="grid md:grid-cols-2 gap-3">
                {GLOSSARY.map((it, i) => (
                  <div key={i} className="rounded-lg border-2 border-yellow-200 bg-white/70 p-3">
                    <div className="font-normal text-gray-900">{it.w}</div>
                    <div className="text-sm text-gray-600 font-light">{it.d}</div>
                  </div>
                ))}
              </div>
            </section>

          </main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<JonasRifurSigUpp />);
  </script>
</body>
</html>
