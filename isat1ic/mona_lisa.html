<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üñºÔ∏è Mona Lisa ‚Äì Lesskilningur</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 0.4s ease both; }
    .answer-option { border: 2px solid #e0e0e0; transition: all 0.2s; cursor: pointer; }
    .answer-option:hover:not(.disabled) { border-color: #2196f3; background: #e3f2fd; }
    .answer-option.selected { border-color: #2196f3; background: #e3f2fd; }
    .answer-option.correct { border-color: #4caf50; background: #e8f5e9; }
    .answer-option.incorrect { border-color: #f44336; background: #ffebee; }
    .answer-option.disabled { cursor: default; }
    .tab-btn { transition: all 0.2s; border-bottom: 3px solid transparent; }
    .tab-btn:hover:not(.tab-active) { background: #f3f4f6; }
    .tab-btn.tab-active { border-bottom: 3px solid #3b82f6; color: #3b82f6; background: white; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    async function callOpenAI(messages, max_tokens = 300) {
      const r = await fetch('/.netlify/functions/openai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ messages, max_tokens, model: 'gpt-4o-mini', temperature: 0.3 })
      });
      const data = await r.json();
      if (!r.ok || data.error) throw new Error(data.error || `HTTP ${r.status}`);
      return data.content;
    }

    const READING_TEXT = `Mona Lisa er √°n efa eitt √æekktasta m√°lverk √≠ heimi. √ûa√∞ er afrakstur snillingsins Leonardo da Vinci, √≠talsks listamanns sem uppi var √° endurreisnart√≠manum. M√°lverki√∞ s√Ωnir konu a√∞ nafni Lisa del Giocondo, sem var gift kaupmanni √≠ Fl√≥rens √° √çtal√≠u. √ûessi dularfulla mynd hefur heilla√∞ listunnendur og fr√¶√∞imenn um allan heim √≠ meira en fimm aldir.

√ûa√∞ eru margar √°st√¶√∞ur fyrir √æv√≠ a√∞ Mona Lisa er svona fr√¶g. Eitt af √æv√≠ sem gerir m√°lverki√∞ einstakt er bros hennar. √ûa√∞ er erfitt a√∞ segja til um hva√∞ h√∫n er a√∞ hugsa e√∞a hva√∞a tilfinningar b√∫a a√∞ baki brosinu. Sumir segja a√∞ h√∫n s√© gl√∂√∞, √° me√∞an a√∞rir telja a√∞ h√∫n s√© sorgm√¶dd e√∞a jafnvel leyndard√≥msfull. √ûessi √≥vissa um tilfinningar hennar hefur gert m√°lverki√∞ enn √°hugaver√∞ara og enn meira heillandi.

Leonardo da Vinci var meistari √≠ a√∞ nota s√©rstaka t√¶kni √≠ m√°lverkum s√≠num. Hann nota√∞i t√¶kni sem kallast ‚Äûsfumato," sem er √≠talskt or√∞ sem √æ√Ω√∞ir ‚Äûa√∞ gufa upp" e√∞a ‚Äûa√∞ reykja." √ûessi t√¶kni felur √≠ s√©r a√∞ m√°la mj√∂g √æunn l√∂g af m√°lningu ofan √° hvert anna√∞ til a√∞ skapa mj√∫k og √≥sk√Ωr m√∂rk. √ûetta gefur andlitinu √° Monu Lisu mj√∫kt og raunverulegt √∫tlit, eins og h√∫n s√© lifandi.

M√°lverki√∞ er ekki mj√∂g st√≥rt, en √æa√∞ er samt mj√∂g √°hrifamiki√∞. √ûa√∞ er 77 sent√≠metrar √° h√¶√∞ og 53 sent√≠metrar √° breidd. Leonardo m√°la√∞i √æa√∞ me√∞ ol√≠u √° tr√©pl√∂tu. Hann byrja√∞i a√∞ vinna a√∞ √æv√≠ um √°ri√∞ 1503 og h√©lt √°fram a√∞ b√¶ta vi√∞ √æa√∞ √≠ m√∂rg √°r. √ûa√∞ er sagt a√∞ hann hafi aldrei tali√∞ √æa√∞ fullkl√°ra√∞.

√ç dag er Mona Lisa til s√Ωnis √≠ Louvre safninu √≠ Par√≠s, Frakklandi. √ûa√∞ hefur veri√∞ √æar s√≠√∞an √°ri√∞ 1797. Safni√∞ er eitt af st√¶rstu og fr√¶gustu listas√∂fnum √≠ heimi. √û√∫sundir manna koma √° hverjum degi til a√∞ sj√° Monu Lisu. Vegna mikilla vins√¶lda getur veri√∞ mj√∂g √ær√∂ngt og erfitt a√∞ komast n√°l√¶gt m√°lverkinu.

√Åri√∞ 1911 ger√∞ist √≥tr√∫legur atbur√∞ur. Monu Lisu var stoli√∞ af Louvre safninu. √ûj√≥furinn var √≠talskur ma√∞ur a√∞ nafni Vincenzo Peruggia. Hann var fyrrverandi starfsma√∞ur safnsins og vildi a√∞ m√°lverki√∞ f√¶ri aftur til √çtal√≠u.

√Åri√∞ 1913 fannst Mona Lisa aftur √° √çtal√≠u. Vincenzo Peruggia reyndi a√∞ selja √æa√∞ til listasala √≠ Fl√≥rens. Listasalinn var√∞ strax tortrygginn og tilkynnti m√°li√∞ til l√∂greglunnar. Peruggia var handtekinn og m√°lverki√∞ f√≥r aftur til Louvre safnsins. Eftir √æj√≥fna√∞inn var√∞ Mona Lisa enn fr√¶gari og vins√¶lli en √°√∞ur.`;

    const MC_QUESTIONS = [
      {
        question: 'Hvar er Mona Lisa til s√Ωnis √≠ dag?',
        options: ['√ç einkasafni √° √çtal√≠u', '√ç Louvre safninu √≠ Par√≠s', '√ç listasafni √≠ Fl√≥rens', '√ç Vat√≠kaninu √≠ R√≥m'],
        correct: 1
      },
      {
        question: 'Hver var Vincenzo Peruggia?',
        options: ['Listama√∞urinn sem m√°la√∞i Mona Lisa', 'Kaupma√∞urinn sem var giftur konu √° m√°lverkinu', '√çtalskur ma√∞ur sem stal Mona Lisa', 'Forstj√≥ri Louvre √°ri√∞ 1911'],
        correct: 2
      },
      {
        question: 'Hva√∞a t√¶kni nota√∞i Leonardo da Vinci til a√∞ m√°la Mona Lisa?',
        options: ['Pointillisma', 'K√∫bisma', 'Sfumato', 'Rauns√¶i'],
        correct: 2
      }
    ];

    const SHORT_QUESTIONS = [
      { q: 'Hver m√°la√∞i Mona Lisa samkv√¶mt textanum?', keywords: ['Leonardo da Vinci', 'Leonardo', 'da Vinci'] },
      { q: 'Hva√∞ er Mona Lisa h√° og brei√∞ samkv√¶mt textanum?', keywords: ['77', '53', 'sent√≠metrar', 'sent√≠metra'] },
      { q: 'Hven√¶r var Mona Lisa stoli√∞ fr√° Louvre safninu samkv√¶mt textanum?', keywords: ['1911'] }
    ];

    const DISCUSSION_QUESTIONS = [
      'Hefur √æ√∫ einhvern t√≠ma upplifa√∞ eitthva√∞ sem var mj√∂g fj√∂lmennt og vins√¶lt, eins og a√∞ sj√° Monu Lisu? Hvernig var s√∫ upplifun?',
      'Mona Lisa er fr√¶g fyrir leyndard√≥msfullt bros sitt. Er eitthva√∞ leyndard√≥msfullt vi√∞ √æig e√∞a einhvern sem √æ√∫ √æekkir?',
      'Monu Lisu var stoli√∞ og fannst svo aftur. Hefur √æ√∫ einhvern t√≠ma t√Ωnt einhverju mikilv√¶gu og fundi√∞ √æa√∞ aftur? Hvernig lei√∞ √æ√©r?'
    ];

    // ‚îÄ‚îÄ Shared UI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    const FeedbackBadge = ({ score, message }) => {
      const color = score >= 4 ? 'green' : score >= 2 ? 'amber' : 'red';
      const colors = {
        green: 'bg-green-50 border-green-200 text-green-800',
        amber: 'bg-amber-50 border-amber-200 text-amber-800',
        red: 'bg-red-50 border-red-200 text-red-800'
      };
      return (
        <div className={`mt-3 p-3 rounded-lg border ${colors[color]} fade-in`}>
          <div className="font-medium text-sm mb-1">Stig: {score}/5</div>
          <p className="text-sm font-light">{message}</p>
        </div>
      );
    };

    // ‚îÄ‚îÄ Tab: Krossaspurningar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    const KrossarTab = ({ onComplete }) => {
      const [answers, setAnswers] = useState([]);
      const [checked, setChecked] = useState(false);

      const score = checked
        ? MC_QUESTIONS.filter((q, i) => answers[i] === q.correct).length
        : null;

      const handleCheck = () => {
        setChecked(true);
        if (onComplete) onComplete(Math.round((score ?? 0) / MC_QUESTIONS.length * 5));
      };

      // Recompute after setChecked
      const computedScore = MC_QUESTIONS.filter((q, i) => answers[i] === q.correct).length;

      return (
        <div className="fade-in space-y-6">
          <p className="text-gray-600 font-light text-sm">Merktu vi√∞ eitt svar (A‚ÄìD).</p>
          {MC_QUESTIONS.map((q, qi) => (
            <div key={qi} className="bg-blue-50 border border-blue-100 rounded-xl p-5">
              <p className="font-medium text-gray-800 mb-4 text-sm">{qi + 1}. {q.question}</p>
              <div className="space-y-2">
                {q.options.map((opt, oi) => {
                  const sel = answers[qi] === oi;
                  const isCorrect = oi === q.correct;
                  const showCorrect = checked && isCorrect;
                  const showWrong = checked && sel && !isCorrect;
                  return (
                    <div key={oi}
                      onClick={() => { if (!checked) { const a = [...answers]; a[qi] = oi; setAnswers(a); } }}
                      className={`answer-option p-3 rounded-lg flex items-center gap-3
                        ${sel && !checked ? 'selected' : ''} 
                        ${showCorrect ? 'correct' : ''} 
                        ${showWrong ? 'incorrect' : ''} 
                        ${checked ? 'disabled' : ''}`}>
                      <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${
                        sel && !checked ? 'border-blue-500 bg-blue-500' :
                        showCorrect ? 'border-green-500 bg-green-500' :
                        showWrong ? 'border-red-500 bg-red-500' : 'border-gray-300'}`}>
                        {(sel || showCorrect) && <div className="w-2 h-2 bg-white rounded-full" />}
                      </div>
                      <span className="font-light text-sm">{String.fromCharCode(65 + oi)}. {opt}</span>
                      {showCorrect && <span className="ml-auto text-green-600">‚úì</span>}
                      {showWrong && <span className="ml-auto text-red-600">‚úó</span>}
                    </div>
                  );
                })}
              </div>
            </div>
          ))}
          {!checked ? (
            <div className="flex gap-3 pt-2">
              <button onClick={handleCheck}
                disabled={answers.length < MC_QUESTIONS.length}
                className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-light text-sm">
                Athuga sv√∂r
              </button>
              <button onClick={() => setAnswers([])}
                className="px-6 py-3 border-2 border-gray-200 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors font-light text-sm">
                Endurstilla
              </button>
            </div>
          ) : (
            <div className="bg-green-50 border-2 border-green-200 rounded-xl p-4 fade-in">
              <p className="text-green-800 font-light">‚úì √û√∫ f√©kkst {computedScore} af {MC_QUESTIONS.length} r√©tt!</p>
              <button onClick={() => { setAnswers([]); setChecked(false); }}
                className="mt-2 px-4 py-2 rounded-lg border-2 border-gray-200 hover:bg-gray-50 font-light text-sm">
                Reyna aftur
              </button>
            </div>
          )}
        </div>
      );
    };

    // ‚îÄ‚îÄ Tab: Stuttar spurningar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    const StuttarTab = ({ onComplete }) => {
      const [answers, setAnswers] = useState(SHORT_QUESTIONS.map(() => ''));
      const [feedback, setFeedback] = useState(SHORT_QUESTIONS.map(() => null));
      const [loading, setLoading] = useState(SHORT_QUESTIONS.map(() => false));

      const checkAnswer = async (i) => {
        const ans = answers[i].trim();
        if (!ans) return;
        const newLoading = [...loading]; newLoading[i] = true; setLoading(newLoading);
        try {
          const result = await callOpenAI([{
            role: 'user',
            content: `√û√∫ ert kennari √≠ √≠slensku sem A2 m√°li. Nemandinn er a√∞ l√¶ra √≠slensku sem anna√∞ m√°l.

Spurning: "${SHORT_QUESTIONS[i].q}"
Svar nemanda: "${ans}"
R√©tt efni √¶tti a√∞ innihalda: ${SHORT_QUESTIONS[i].keywords.join(', ')}

Mettu svari√∞. Vera sveigjanlegur me√∞ or√∞alag en n√°kv√¶m me√∞ sta√∞reyndir.
Svara√∞u EINUNGIS √° √æessu formi:
STIG: [tala 0-5]
ENDURGJ√ñF: [ein setning, vinaleg og √° √≠slensku]`
          }], 150);
          const stigMatch = result.match(/STIG:\s*(\d)/);
          const endurgjofMatch = result.match(/ENDURGJ√ñF:\s*(.+)/);
          const score = stigMatch ? parseInt(stigMatch[1]) : 0;
          const msg = endurgjofMatch ? endurgjofMatch[1].trim() : result.trim();
          const newFeedback = [...feedback]; newFeedback[i] = { score, msg }; setFeedback(newFeedback);
          // Check if all done
          const allDone = feedback.map((f, idx) => idx === i ? { score, msg } : f).every(f => f !== null);
          if (allDone && onComplete) {
            const total = feedback.map((f, idx) => idx === i ? score : (f?.score ?? 0)).reduce((a, b) => a + b, 0);
            onComplete(Math.round(total / SHORT_QUESTIONS.length));
          }
        } catch(e) {
          const newFeedback = [...feedback]; newFeedback[i] = { score: 0, msg: 'Gat ekki tengst. Reyndu aftur.' }; setFeedback(newFeedback);
        }
        const nl = [...loading]; nl[i] = false; setLoading(nl);
      };

      return (
        <div className="fade-in space-y-6">
          <p className="text-gray-600 font-light text-sm">Svara√∞u me√∞ √æ√≠num eigin or√∞um (1‚Äì2 setningar).</p>
          {SHORT_QUESTIONS.map((q, i) => (
            <div key={i} className="bg-blue-50 border border-blue-100 rounded-xl p-5">
              <p className="font-medium text-gray-800 mb-3 text-sm">{i + 1}. {q.q}</p>
              {!feedback[i] ? (
                <div className="space-y-3">
                  <textarea
                    value={answers[i]}
                    onChange={e => { const a = [...answers]; a[i] = e.target.value; setAnswers(a); }}
                    rows={3}
                    placeholder="Skrifa√∞u svari√∞ √æitt h√©r..."
                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-light resize-none text-sm disabled:bg-gray-50"
                    disabled={loading[i]}
                  />
                  <button onClick={() => checkAnswer(i)}
                    disabled={!answers[i].trim() || loading[i]}
                    className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-light text-sm">
                    {loading[i] ? 'Athuga...' : 'Athuga svar'}
                  </button>
                </div>
              ) : (
                <div>
                  <p className="text-sm text-gray-600 font-light italic mb-2">‚Äû{answers[i]}"</p>
                  <FeedbackBadge score={feedback[i].score} message={feedback[i].msg} />
                  <button onClick={() => {
                    const nf = [...feedback]; nf[i] = null; setFeedback(nf);
                    const na = [...answers]; na[i] = ''; setAnswers(na);
                  }} className="mt-3 px-4 py-2 rounded-lg border-2 border-gray-200 hover:bg-gray-50 font-light text-xs">
                    Reyna aftur
                  </button>
                </div>
              )}
            </div>
          ))}
        </div>
      );
    };

    // ‚îÄ‚îÄ Tab: Umr√¶√∞a ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    const UmraeduSpurning = ({ question, index }) => {
      const [messages, setMessages] = useState([]);
      const [input, setInput] = useState('');
      const [loading, setLoading] = useState(false);
      const chatRef = useRef(null);

      useEffect(() => {
        if (chatRef.current) chatRef.current.scrollTop = chatRef.current.scrollHeight;
      }, [messages]);

      const send = async () => {
        const text = input.trim();
        if (!text || loading) return;
        const newMessages = [...messages, { role: 'user', content: text }];
        setMessages(newMessages);
        setInput('');
        setLoading(true);
        try {
          const history = newMessages.map(m => ({ role: m.role, content: m.content }));
          const result = await callOpenAI([
            {
              role: 'system',
              content: `√û√∫ ert vingjarnlegur √≠slenskukennarinn. Nemandinn er a√∞ l√¶ra √≠slensku sem A2 tungum√°l. 
Spurningin sem vi√∞ r√¶√∞um er: "${question}"
Svara√∞u ALLTAF √° √≠slensku. Vertu hvetjandi og styddu nemandann. 
Ef nemandinn skrifar √° √∂√∞ru m√°li, svara√∞u √° √≠slensku en getur b√¶tt vi√∞ √æ√Ω√∞ingu √≠ sviga.
Kommenta√∞u √° svari√∞ (1-2 setningar) og spyr√∞u einnar follow-up spurningar til a√∞ halda samtali √°fram.
Haltu sv√∂rum stuttum og einf√∂ldum (A2 stig).`
            },
            ...history
          ], 250);
          setMessages([...newMessages, { role: 'assistant', content: result }]);
        } catch(e) {
          setMessages([...newMessages, { role: 'assistant', content: 'Gat ekki tengst. Reyndu aftur.' }]);
        }
        setLoading(false);
      };

      return (
        <div className="bg-blue-50 border border-blue-100 rounded-xl p-5">
          <p className="font-medium text-gray-800 mb-4 text-sm">{index + 1}. {question}</p>
          {messages.length > 0 && (
            <div ref={chatRef} className="mb-4 space-y-3 max-h-60 overflow-y-auto pr-1">
              {messages.map((m, i) => (
                <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                  <div className={`max-w-xs px-4 py-2 rounded-2xl text-sm font-light leading-relaxed ${
                    m.role === 'user'
                      ? 'bg-blue-600 text-white rounded-br-sm'
                      : 'bg-white text-gray-800 shadow-sm border border-gray-100 rounded-bl-sm'
                  }`}>
                    {m.content}
                  </div>
                </div>
              ))}
              {loading && (
                <div className="flex justify-start">
                  <div className="bg-white border border-gray-100 rounded-2xl rounded-bl-sm px-4 py-3 shadow-sm">
                    <div className="flex gap-1">
                      {[0,1,2].map(i => (
                        <div key={i} className="w-2 h-2 bg-gray-300 rounded-full animate-bounce"
                          style={{ animationDelay: `${i * 0.15}s` }} />
                      ))}
                    </div>
                  </div>
                </div>
              )}
            </div>
          )}
          <div className="flex gap-2">
            <textarea
              value={input}
              onChange={e => setInput(e.target.value)}
              onKeyDown={e => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); } }}
              rows={2}
              placeholder="Skrifa√∞u svar √æitt h√©r..."
              className="flex-1 px-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-light resize-none text-sm disabled:bg-gray-50"
              disabled={loading}
            />
            <button onClick={send} disabled={!input.trim() || loading}
              className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-light text-sm self-end">
              Senda
            </button>
          </div>
        </div>
      );
    };

    const UmraeduTab = ({ onComplete }) => {
      const [msgCounts, setMsgCounts] = useState(DISCUSSION_QUESTIONS.map(() => 0));

      useEffect(() => {
        if (msgCounts.every(c => c >= 1) && onComplete) onComplete(5);
      }, [msgCounts]);

      return (
        <div className="fade-in space-y-6">
          <p className="text-gray-600 font-light text-sm">Svara√∞u spurningunum √° √≠slensku. Kennarinn hj√°lpar √æ√©r!</p>
          {DISCUSSION_QUESTIONS.map((q, i) => (
            <UmraeduSpurning key={i} question={q} index={i} />
          ))}
        </div>
      );
    };

    // ‚îÄ‚îÄ A√∞alforrit ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    const App = () => {
      const [showText, setShowText] = useState(true);
      const [activeTab, setActiveTab] = useState('krossar');
      const [completed, setCompleted] = useState({ krossar: false, stuttar: false, umraeda: false });

      const TABS = [
        { id: 'krossar', label: 'Krossaspurningar', icon: '‚úì' },
        { id: 'stuttar', label: 'Stuttar spurningar', icon: 'üìù' },
        { id: 'umraeda', label: 'Umr√¶√∞a', icon: 'üí¨' }
      ];

      const doneCount = Object.values(completed).filter(Boolean).length;

      const markDone = (tab) => setCompleted(prev => ({ ...prev, [tab]: true }));

      return (
        <div className="min-h-screen pb-16">
          {/* Header */}
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-4xl mx-auto px-6 py-8">
              <button onClick={() => window.history.back()}
                className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">
                ‚Üê Til baka
              </button>
              <h1 className="text-3xl font-light text-gray-800 mb-1">üñºÔ∏è Mona Lisa</h1>
              <p className="text-gray-500 text-sm font-light">Lesskilningur ¬∑ A1‚ÄìA2</p>
            </div>
          </header>

          <main className="max-w-4xl mx-auto px-6 mt-8 space-y-6">

            {/* Textabox */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-100">
              <button
                onClick={() => setShowText(v => !v)}
                className="w-full flex items-center justify-between px-6 py-4 text-left">
                <span className="font-medium text-gray-800 flex items-center gap-2">
                  üìñ Lesefni√∞
                </span>
                <span className="text-gray-400 text-sm font-light">
                  {showText ? '‚ñ≤ Fela' : '‚ñº S√Ωna'}
                </span>
              </button>
              {showText && (
                <div className="px-6 pb-6 border-t border-gray-100 fade-in">
                  {READING_TEXT.split('\n\n').map((p, i) => (
                    <p key={i} className="mt-4 text-gray-700 font-light leading-relaxed text-sm">{p}</p>
                  ))}
                </div>
              )}
            </div>

            {/* Flipar */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
              {/* Tab-stika */}
              <div className="flex border-b border-gray-100 bg-gray-50">
                {TABS.map(tab => (
                  <button key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`tab-btn flex-1 px-4 py-4 text-sm font-light flex items-center justify-center gap-2 relative ${activeTab === tab.id ? 'tab-active' : 'text-gray-500'}`}>
                    <span>{tab.icon}</span>
                    <span className="hidden sm:inline">{tab.label}</span>
                    {completed[tab.id] && (
                      <span className="absolute top-2 right-2 w-4 h-4 bg-green-500 text-white rounded-full text-xs flex items-center justify-center">‚úì</span>
                    )}
                  </button>
                ))}
              </div>

              {/* Tab-innihald */}
              <div className="p-6">
                {activeTab === 'krossar' && (
                  <KrossarTab onComplete={() => markDone('krossar')} />
                )}
                {activeTab === 'stuttar' && (
                  <StuttarTab onComplete={() => markDone('stuttar')} />
                )}
                {activeTab === 'umraeda' && (
                  <UmraeduTab onComplete={() => markDone('umraeda')} />
                )}
              </div>
            </div>

            {/* Framvindustika */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-100 px-6 py-4">
              <div className="flex items-center justify-between mb-2">
                <span className="text-sm text-gray-600 font-light">Framvinda</span>
                <span className="text-sm text-gray-500 font-light">{doneCount}/{TABS.length} loki√∞</span>
              </div>
              <div className="flex gap-2">
                {TABS.map(tab => (
                  <div key={tab.id}
                    className={`h-2 flex-1 rounded-full transition-all duration-500 ${completed[tab.id] ? 'bg-green-500' : activeTab === tab.id ? 'bg-blue-300' : 'bg-gray-200'}`} />
                ))}
              </div>
              {doneCount === TABS.length && (
                <p className="mt-3 text-center text-green-700 font-light text-sm fade-in">üéâ Vel gert! √û√∫ hefur loki√∞ √∂llum verkefnum.</p>
              )}
            </div>

          </main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
