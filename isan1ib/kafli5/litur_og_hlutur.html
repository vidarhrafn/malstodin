<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>L√Ωsingaror√∞ - Litir</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f0f9ff 0%, #e0f2fe 100%);
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const AdjectiveExercise = () => {
      const [currentPart, setCurrentPart] = useState(1);
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [score, setScore] = useState(0);
      const [selectedAnswer, setSelectedAnswer] = useState('');
      const [showFeedback, setShowFeedback] = useState(false);
      const [firstAttempt, setFirstAttempt] = useState(true);
      const [userAnswer, setUserAnswer] = useState('');
      const [isComplete, setIsComplete] = useState(false);

      const dropdownQuestions = [
        { noun: 'panna', gender: 'kvk', correct: 'gr√°', options: ['gr√°r', 'gr√°', 'gr√°tt'] },
        { noun: 'bolli', gender: 'kk', correct: 'rau√∞ur', options: ['rau√∞ur', 'rau√∞', 'rautt'] },
        { noun: 'bor√∞', gender: 'hk', correct: 'hv√≠tt', options: ['hv√≠tur', 'hv√≠t', 'hv√≠tt'] },
        { noun: 'st√≥ll', gender: 'kk', correct: 'bl√°r', options: ['bl√°r', 'bl√°', 'bl√°tt'] },
        { noun: 'diskur', gender: 'kk', correct: 'gr√¶nn', options: ['gr√¶nn', 'gr√¶n', 'gr√¶nt'] },
        { noun: 'peysa', gender: 'kvk', correct: 'sv√∂rt', options: ['svartur', 'sv√∂rt', 'svart'] },
        { noun: 'kl√≥sett', gender: 'hk', correct: 'gult', options: ['gulur', 'gul', 'gult'] },
        { noun: 'gaffall', gender: 'kk', correct: 'br√∫nn', options: ['br√∫nn', 'br√∫n', 'br√∫nt'] },
        { noun: 's√°pa', gender: 'kvk', correct: 'bleik', options: ['bleikur', 'bleik', 'bleikt'] },
        { noun: 'jakki', gender: 'kk', correct: 'appels√≠nugulur', options: ['appels√≠nugulur', 'appels√≠nugul', 'appels√≠nugult'] }
      ];

      const writingQuestions = [
        { 
          emoji: 'üç≥', 
          acceptedAnswers: [{ noun: 'panna', gender: 'kvk', adjective: 'sv√∂rt' }],
          colorBase: 'svartur',
          colorForms: { kk: 'svartur', kvk: 'sv√∂rt', hk: 'svart' }
        },
        { 
          emoji: 'üëï', 
          acceptedAnswers: [{ noun: 'bolur', gender: 'kk', adjective: 'gr√¶nn' }],
          colorBase: 'gr√¶nn',
          colorForms: { kk: 'gr√¶nn', kvk: 'gr√¶n', hk: 'gr√¶nt' }
        },
        { 
          emoji: 'üöΩ', 
          acceptedAnswers: [{ noun: 'kl√≥sett', gender: 'hk', adjective: 'hv√≠tt' }],
          colorBase: 'hv√≠tur',
          colorForms: { kk: 'hv√≠tur', kvk: 'hv√≠t', hk: 'hv√≠tt' }
        },
        { 
          emoji: 'üî™', 
          acceptedAnswers: [
            { noun: 'hn√≠fur', gender: 'kk', adjective: 'gr√°r' },
            { noun: 'hn√≠fur', gender: 'kk', adjective: 'bl√°r' }
          ],
          colorBase: 'gr√°r e√∞a bl√°r',
          colorForms: { kk: ['gr√°r', 'bl√°r'], kvk: ['gr√°', 'bl√°'], hk: ['gr√°tt', 'bl√°tt'] }
        },
        { 
          emoji: 'üëó', 
          acceptedAnswers: [{ noun: 'kj√≥ll', gender: 'kk', adjective: 'bl√°r' }],
          colorBase: 'bl√°r',
          colorForms: { kk: 'bl√°r', kvk: 'bl√°', hk: 'bl√°tt' }
        },
        { 
          emoji: 'üß•', 
          acceptedAnswers: [
            { noun: '√∫lpa', gender: 'kvk', adjective: 'br√∫n' },
            { noun: 'jakki', gender: 'kk', adjective: 'br√∫nn' },
            { noun: 'frakki', gender: 'kk', adjective: 'br√∫nn' }
          ],
          colorBase: 'br√∫nn',
          colorForms: { kk: 'br√∫nn', kvk: 'br√∫n', hk: 'br√∫nt' }
        },
        { 
          emoji: 'ü™ë', 
          acceptedAnswers: [{ noun: 'st√≥ll', gender: 'kk', adjective: 'br√∫nn' }],
          colorBase: 'br√∫nn',
          colorForms: { kk: 'br√∫nn', kvk: 'br√∫n', hk: 'br√∫nt' }
        },
        { 
          emoji: 'üßº', 
          acceptedAnswers: [{ noun: 's√°pa', gender: 'kvk', adjective: 'bleik' }],
          colorBase: 'bleikur',
          colorForms: { kk: 'bleikur', kvk: 'bleik', hk: 'bleikt' }
        }
      ];

      const getGenderName = (gender) => {
        if (gender === 'kk') return 'karlkyn';
        if (gender === 'kvk') return 'kvenkyn';
        return 'hvorugkyn';
      };

      const handleDropdownSelect = (answer) => {
        if (showFeedback) return;
        setSelectedAnswer(answer);
      };

      const handleDropdownSubmit = () => {
        if (!selectedAnswer) return;
        setShowFeedback(true);
        const currentQ = dropdownQuestions[currentQuestion];
        const isCorrect = selectedAnswer === currentQ.correct;

        if (isCorrect) {
          if (firstAttempt) setScore(score + 1);
          setTimeout(() => {
            if (currentQuestion < dropdownQuestions.length - 1) {
              setCurrentQuestion(currentQuestion + 1);
              setSelectedAnswer('');
              setShowFeedback(false);
              setFirstAttempt(true);
            } else {
              setCurrentPart(2);
              setCurrentQuestion(0);
              setSelectedAnswer('');
              setShowFeedback(false);
              setFirstAttempt(true);
            }
          }, 1500);
        } else {
          if (firstAttempt) {
            setFirstAttempt(false);
            setTimeout(() => {
              setSelectedAnswer('');
              setShowFeedback(false);
            }, 2500);
          } else {
            setTimeout(() => {
              if (currentQuestion < dropdownQuestions.length - 1) {
                setCurrentQuestion(currentQuestion + 1);
                setSelectedAnswer('');
                setShowFeedback(false);
                setFirstAttempt(true);
              } else {
                setCurrentPart(2);
                setCurrentQuestion(0);
                setSelectedAnswer('');
                setShowFeedback(false);
                setFirstAttempt(true);
              }
            }, 2500);
          }
        }
      };

      const [feedbackMessage, setFeedbackMessage] = useState('');

      const checkWritingAnswer = (answer, question) => {
        const parts = answer.toLowerCase().trim().split(/\s+/);
        if (parts.length !== 2) {
          return { correct: false, message: 'Skrifa√∞u b√¶√∞i l√Ωsingaror√∞ og nafnor√∞ (t.d. "sv√∂rt panna").' };
        }
        const [adj, noun] = parts;
        const matchedNoun = question.acceptedAnswers.find(a => a.noun.toLowerCase() === noun);
        if (!matchedNoun) {
          const validNouns = question.acceptedAnswers.map(a => a.noun).join(' / ');
          return { correct: false, message: `Nafnor√∞i√∞ er ekki r√©tt. Pr√≥fa√∞u: ${validNouns}` };
        }
        const correctAdj = question.acceptedAnswers.find(a => a.noun.toLowerCase() === noun && a.adjective.toLowerCase() === adj);
        if (correctAdj) {
          return { correct: true, message: '' };
        }
        const colorForms = question.colorForms[matchedNoun.gender];
        const validColors = Array.isArray(colorForms) ? colorForms : [colorForms];
        const isValidColor = validColors.some(c => c.toLowerCase() === adj);
        if (isValidColor) {
          return { correct: true, message: '' };
        }
        const allColorForms = Object.values(question.colorForms).flat();
        const usedWrongForm = allColorForms.some(c => c.toLowerCase() === adj);
        if (usedWrongForm) {
          const genderName = matchedNoun.gender === 'kk' ? 'karlkyn' : matchedNoun.gender === 'kvk' ? 'kvenkyn' : 'hvorugkyn';
          const correctForm = validColors[0];
          return { correct: false, message: `Athuga√∞u a√∞ or√∞i√∞ "${matchedNoun.noun}" er ${genderName}. R√©tt form er "${correctForm}".` };
        }
        return { correct: false, message: `Liturinn er ${question.colorBase}. Reyndu aftur!` };
      };

      const handleWritingSubmit = () => {
        if (!userAnswer.trim()) return;
        const currentQ = writingQuestions[currentQuestion];
        const result = checkWritingAnswer(userAnswer, currentQ);
        setFeedbackMessage(result.message);
        setShowFeedback(true);

        if (result.correct) {
          if (firstAttempt) setScore(score + 1);
          setTimeout(() => {
            if (currentQuestion < writingQuestions.length - 1) {
              setCurrentQuestion(currentQuestion + 1);
              setUserAnswer('');
              setShowFeedback(false);
              setFirstAttempt(true);
              setFeedbackMessage('');
            } else {
              setIsComplete(true);
            }
          }, 1500);
        } else {
          if (firstAttempt) {
            setFirstAttempt(false);
            setTimeout(() => {
              setUserAnswer('');
              setShowFeedback(false);
            }, 3500);
          } else {
            const correctExample = currentQ.acceptedAnswers[0];
            setFeedbackMessage(`R√©tt svar: ${correctExample.adjective} ${correctExample.noun}`);
            setTimeout(() => {
              if (currentQuestion < writingQuestions.length - 1) {
                setCurrentQuestion(currentQuestion + 1);
                setUserAnswer('');
                setShowFeedback(false);
                setFirstAttempt(true);
                setFeedbackMessage('');
              } else {
                setIsComplete(true);
              }
            }, 3500);
          }
        }
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !showFeedback) {
          handleWritingSubmit();
        }
      };

      const resetExercise = () => {
        setCurrentPart(1);
        setCurrentQuestion(0);
        setScore(0);
        setSelectedAnswer('');
        setShowFeedback(false);
        setFirstAttempt(true);
        setUserAnswer('');
        setIsComplete(false);
        setFeedbackMessage('');
      };

      const totalQuestions = dropdownQuestions.length + writingQuestions.length;
      const percentage = Math.round((score / totalQuestions) * 100);

      if (isComplete) {
        return (
          <div className="min-h-screen pb-12">
            <header className="bg-white shadow-sm border-b border-gray-200">
              <div className="max-w-4xl mx-auto px-6 py-8">
                <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">‚Üê Til baka</button>
                <h1 className="text-3xl font-light text-gray-800 mb-2">L√Ωsingaror√∞ - Litir</h1>
                <p className="text-gray-500 text-sm font-light">Kafli 4 - √âg er kominn heim ¬∑ A1-A2</p>
              </div>
            </header>
            <main className="max-w-4xl mx-auto px-6 mt-8">
              <div className="bg-white rounded-lg shadow-xl p-12 text-center">
                <div className="text-6xl mb-6">üéâ</div>
                <h2 className="text-3xl font-light text-gray-800 mb-4">Vel gert!</h2>
                <div className="text-7xl font-bold text-blue-600 mb-6">{percentage}%</div>
                <p className="text-xl text-gray-600 font-light mb-8">√û√∫ f√©kkst <span className="font-normal">{score}</span> af <span className="font-normal">{totalQuestions}</span> r√©tt</p>
                <button onClick={resetExercise} className="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-normal hover:bg-blue-700 transition-colors shadow-lg">üîÑ Pr√≥fa aftur</button>
              </div>
            </main>
          </div>
        );
      }

      if (currentPart === 1) {
        const currentQ = dropdownQuestions[currentQuestion];
        const progress = ((currentQuestion + 1) / dropdownQuestions.length) * 100;
        const isCorrect = selectedAnswer === currentQ.correct;

        return (
          <div className="min-h-screen pb-12">
            <header className="bg-white shadow-sm border-b border-gray-200">
              <div className="max-w-4xl mx-auto px-6 py-8">
                <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">‚Üê Til baka</button>
                <h1 className="text-3xl font-light text-gray-800 mb-2">L√Ωsingaror√∞ - Litir</h1>
                <p className="text-gray-500 text-sm font-light">Hluti 1: Veldu r√©tta mynd ¬∑ {currentQuestion + 1} / {dropdownQuestions.length}</p>
              </div>
            </header>
            <main className="max-w-4xl mx-auto px-6 mt-8">
              <div className="bg-white rounded-lg shadow-xl p-8">
                <div className="mb-8">
                  <div className="w-full bg-gray-200 rounded-full h-3">
                    <div className="bg-blue-600 h-3 rounded-full transition-all duration-300" style={{ width: `${progress}%` }} />
                  </div>
                </div>
                <div className="text-center mb-8">
                  <p className="text-4xl text-gray-800 font-light">
                    √ûetta er{' '}
                    <select
                      value={selectedAnswer}
                      onChange={(e) => handleDropdownSelect(e.target.value)}
                      disabled={showFeedback}
                      className="text-4xl font-normal border-b-4 border-blue-400 bg-blue-50 px-4 py-2 rounded focus:outline-none focus:border-blue-600 cursor-pointer"
                    >
                      <option value="">...</option>
                      {currentQ.options.map((opt) => (
                        <option key={opt} value={opt}>{opt}</option>
                      ))}
                    </select>
                    {' '}<span className="font-normal">{currentQ.noun}</span>.
                  </p>
                </div>
                {showFeedback && (
                  <div className={`mb-6 p-6 rounded-lg text-center text-xl font-normal border-2 ${isCorrect ? 'bg-green-100 text-green-800 border-green-300' : 'bg-red-100 text-red-800 border-red-300'}`}>
                    {isCorrect ? (
                      <span>‚úÖ R√©tt!</span>
                    ) : firstAttempt ? (
                      <span>‚ùå Ekki r√©tt. Athuga√∞u a√∞ <strong>{currentQ.noun}</strong> er <strong>{getGenderName(currentQ.gender)}</strong>. Reyndu aftur!</span>
                    ) : (
                      <span>‚ùå Ekki r√©tt. R√©tt svar: <strong>{currentQ.correct} {currentQ.noun}</strong></span>
                    )}
                  </div>
                )}
                {!showFeedback && (
                  <div className="text-center">
                    <button
                      onClick={handleDropdownSubmit}
                      disabled={!selectedAnswer}
                      className="px-8 py-4 bg-blue-600 text-white text-xl font-normal rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                    >
                      Athuga
                    </button>
                  </div>
                )}
              </div>
            </main>
          </div>
        );
      }

      const currentQ = writingQuestions[currentQuestion];
      const progress = ((currentQuestion + 1) / writingQuestions.length) * 100;

      return (
        <div className="min-h-screen pb-12">
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-4xl mx-auto px-6 py-8">
              <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">‚Üê Til baka</button>
              <h1 className="text-3xl font-light text-gray-800 mb-2">L√Ωsingaror√∞ - Litir</h1>
              <p className="text-gray-500 text-sm font-light">Hluti 2: Skrifa√∞u l√Ωsingaror√∞i√∞ ¬∑ {currentQuestion + 1} / {writingQuestions.length}</p>
            </div>
          </header>
          <main className="max-w-4xl mx-auto px-6 mt-8">
            <div className="bg-white rounded-lg shadow-xl p-8">
              <div className="mb-8">
                <div className="w-full bg-gray-200 rounded-full h-3">
                  <div className="bg-blue-600 h-3 rounded-full transition-all duration-300" style={{ width: `${progress}%` }} />
                </div>
              </div>
              <div className="text-center mb-8">
                <div className="text-9xl mb-6">{currentQ.emoji}</div>
                <p className="text-3xl text-gray-800 font-light mb-4">
                  √ûetta er{' '}
                  <input
                    type="text"
                    value={userAnswer}
                    onChange={(e) => setUserAnswer(e.target.value)}
                    onKeyPress={handleKeyPress}
                    disabled={showFeedback}
                    placeholder="_____ _____"
                    className="text-3xl font-normal border-b-4 border-blue-400 bg-blue-50 px-4 py-2 w-64 text-center rounded focus:outline-none focus:border-blue-600"
                    autoFocus
                  />.
                </p>
                <p className="text-gray-500 font-light text-lg">Skrifa√∞u l√Ωsingaror√∞ + nafnor√∞ (t.d. ‚Äûsv√∂rt panna")</p>
              </div>
              {showFeedback && (
                <div className={`mb-6 p-6 rounded-lg text-center text-xl font-normal border-2 ${!feedbackMessage ? 'bg-green-100 text-green-800 border-green-300' : 'bg-red-100 text-red-800 border-red-300'}`}>
                  {!feedbackMessage ? (
                    <span>‚úÖ R√©tt!</span>
                  ) : (
                    <span>‚ùå {feedbackMessage}</span>
                  )}
                </div>
              )}
              {!showFeedback && (
                <div className="text-center">
                  <button
                    onClick={handleWritingSubmit}
                    disabled={!userAnswer.trim()}
                    className="px-8 py-4 bg-blue-600 text-white text-xl font-normal rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                  >
                    Athuga
                  </button>
                </div>
              )}
            </div>
          </main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<AdjectiveExercise />);
  </script>
</body>
</html>
