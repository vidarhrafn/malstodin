<!doctype html>
<html lang="is">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Finndu l√Ωsingaror√∞in</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin: 0; padding: 24px; background: #f7f7f8; color: #111; }
    .card{
      max-width: 980px; margin: 0 auto; background:#fff;
      border:1px solid #e6e6ea; border-radius:14px;
      padding:18px 18px 14px; box-shadow:0 2px 10px rgba(0,0,0,.04);
    }
    h1{ margin:0 0 8px; font-size:20px; }
    p.help{ margin:0 0 14px; color:#444; line-height:1.35; }
    .toolbar{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom:12px; }
    .pill{
      display:inline-flex; gap:8px; align-items:center; padding:8px 10px;
      border-radius:999px; border:1px solid #e6e6ea; background:#fafafa; font-size:14px;
    }
    button{
      border:1px solid #d6d6db; background:#fff; border-radius:10px;
      padding:9px 12px; font-size:14px; cursor:pointer;
    }
    button:hover{ background:#f2f2f4; }
    .feedback{
      margin-top:10px; padding:10px 12px; border-radius:12px;
      background:#f6f6ff; border:1px solid #e7e7ff;
      min-height:20px; line-height:1.35;
    }
    .text{ margin-top:14px; font-size:18px; line-height:1.8; user-select:none; }
    .w{
      display:inline-block; padding:2px 3px; margin:1px 1px;
      border-radius:8px; cursor:pointer;
      transition:background .12s ease, transform .06s ease;
    }
    .w:hover{ background:#f2f2f6; }
    .w:active{ transform:scale(.98); }

    .correct{ background:#e7f7ea !important; border:1px solid #bfe8c6; }
    .wrongFlash{ animation:flash .35s ease-in-out 1; }
    @keyframes flash{
      0%{ background:#ffe7e7; }
      60%{ background:#ffe7e7; }
      100%{ background:transparent; }
    }
    .legend{ margin-top:14px; color:#555; font-size:13px; }
    .small{ font-size:13px; color:#666; }
    .done{ background:#eef7ff; border:1px solid #cfe8ff; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Finndu l√Ωsingaror√∞in</h1>
    <p class="help">
      Smelltu √° or√∞in √≠ textanum og reyndu a√∞ finna <strong>l√Ωsingaror√∞</strong>.
      Ef √æ√∫ smellir √° rangt or√∞ f√¶r√∞u a√∞ vita hva√∞a or√∞flokkur √æa√∞ er.
    </p>

    <div class="toolbar">
      <div class="pill"><strong>R√©tt:</strong> <span id="score">0</span> / <span id="total">0</span></div>
      <button id="resetBtn" type="button">Endurstilla</button>
      <span class="small">√Åbending: L√Ωsingaror√∞ l√Ωsa oft hlutum (t.d. <em>gott, hl√Ωtt, kalt</em>).</span>
    </div>

    <div id="feedback" class="feedback">Byrja√∞u a√∞ smella √° or√∞.</div>
    <div id="text" class="text" aria-label="Texti til a√∞ smella √°"></div>

    <div class="legend">
      <span>‚úÖ gr√¶nt = r√©tt l√Ωsingaror√∞</span>
      <span style="margin-left:10px;">‚ùå rau√∞ur blikk = rangt</span>
    </div>
  </div>

<script>
(() => {
  const rawText = `Ve√∞ri√∞ var gott og hl√Ωtt. Solla var √°n√¶g√∞ √∫ti √≠ s√≥lskininu. H√∫n var √≠ n√Ωju √∫lpunni sinni. St√≥ru str√°karnir l√©ku s√©r me√∞ svarta og hv√≠ta f√≥tboltann og ungu krakkarnir voru √≠ st√≥ru leikt√¶kjunum. Stelpurnar t√∂lu√∞u h√°tt √° sk√≥lal√≥√∞inni. √û√¶r komu heitar inn √∫r fr√≠m√≠n√∫tum. Kennarinn var rei√∞ur. Hann sag√∞i √æessum l√∂tum nemendum a√∞ setjast strax √° g√∂mlu st√≥lana. En hva√∞ √æa√∞ var kalt √≠ stofunni. Olla vildi vera √≠ rau√∞u √∫lpunni sinni inni √≠ kennslustofunni. Anna f√≥r inn √≠ h√°u le√∞urst√≠gv√©lunum. J√≥i var me√∞ gr√¶nu derh√∫funa og Biggi me√∞ r√∂nd√≥tta trefil um h√°lsinn.`;

  // L√Ωsingaror√∞ √≠ textanum (eins og √æau birtast h√©r)
  const ADJ = new Set([
    "gott","hl√Ωtt","√°n√¶g√∞","n√Ωju","st√≥ru","svarta","hv√≠ta","ungu",
    "heitar","rei√∞ur","l√∂tum","g√∂mlu","kalt","rau√∞u","h√°u","gr√¶nu","r√∂nd√≥tta"
  ]);

  // Einf√∂ld or√∞flokkun fyrir r√∂ng val (handgert fyrir √æennan texta).
  const POS = new Map([
    // Nafnor√∞
    ["ve√∞ri√∞","nafnor√∞"],["solla","nafnor√∞"],["s√≥lskininu","nafnor√∞"],["√∫lpunni","nafnor√∞"],
    ["str√°karnir","nafnor√∞"],["f√≥tboltann","nafnor√∞"],["krakkarnir","nafnor√∞"],["leikt√¶kjunum","nafnor√∞"],
    ["stelpurnar","nafnor√∞"],["sk√≥lal√≥√∞inni","nafnor√∞"],["fr√≠m√≠n√∫tum","nafnor√∞"],["kennarinn","nafnor√∞"],
    ["nemendum","nafnor√∞"],["st√≥lana","nafnor√∞"],["stofunni","nafnor√∞"],["olla","nafnor√∞"],
    ["kennslustofunni","nafnor√∞"],["anna","nafnor√∞"],["le√∞urst√≠gv√©lunum","nafnor√∞"],
    ["j√≥i","nafnor√∞"],["derh√∫funa","nafnor√∞"],["biggi","nafnor√∞"],["trefil","nafnor√∞"],["h√°lsinn","nafnor√∞"],

    // Sagnor√∞
    ["var","sagnor√∞"],["voru","sagnor√∞"],["l√©ku","sagnor√∞"],["t√∂lu√∞u","sagnor√∞"],["komu","sagnor√∞"],
    ["sag√∞i","sagnor√∞"],["setjast","sagnor√∞"],["vildi","sagnor√∞"],["vera","sagnor√∞"],["f√≥r","sagnor√∞"],

    // Forn√∂fn / √°bendingaror√∞
    ["h√∫n","fornafn"],["√æ√¶r","fornafn"],["hann","fornafn"],["√æessum","√°bendingarfornafn"],
    ["hva√∞","spurnarfornafn"],["√æa√∞","fornafn"],["sinni","eignarfornafn"],["s√©r","afturbeygt fornafn"],

    // Atviksor√∞
    ["√∫ti","atviksor√∞"],["h√°tt","atviksor√∞"],["strax","atviksor√∞"],["inni","atviksor√∞"],

    // Forsetningar
    ["√≠","forsetning"],["me√∞","forsetning"],["√°","forsetning"],["inn","forsetning"],["√∫r","forsetning"],["um","forsetning"],

    // Samtengingar
    ["og","samtenging"],["en","samtenging"],

    // Nafnh√°ttarmerki
    ["a√∞","nafnh√°ttarmerki"]
  ]);

  const elText = document.getElementById("text");
  const elFeedback = document.getElementById("feedback");
  const elScore = document.getElementById("score");
  const elTotal = document.getElementById("total");
  const resetBtn = document.getElementById("resetBtn");

  // Unicode-√∂rugg tokenization:
  // - \p{L} = hva√∞a b√≥kstafur sem er (inkl. √∞/√ê)
  // - \p{M} = samsetningarmerki (t.d. √°herslumerki)
  // - \p{N} = t√∂lur
  // Tekur or√∞ sem runu af b√≥kstaf + (b√≥kstaf/merki)*
  function tokenize(str) {
    return str.match(/[\p{L}\p{M}]+|[\p{N}]+|[^\s\p{L}\p{M}\p{N}]/gu) || [];
  }

  function norm(w) {
    return w.toLocaleLowerCase("is-IS");
  }

  const tokens = tokenize(rawText);

  // Telja heildarfj√∂lda l√Ωsingaror√∞a (me√∞ endurtekningum)
  const adjectiveTokenIndexes = [];
  tokens.forEach((t, idx) => {
    const n = norm(t);
    if (ADJ.has(n)) adjectiveTokenIndexes.push(idx);
  });
  const totalAdjs = adjectiveTokenIndexes.length;
  elTotal.textContent = String(totalAdjs);

  let found = new Set();

  function setFeedback(msg, done=false) {
    elFeedback.textContent = msg;
    elFeedback.classList.toggle("done", done);
  }

  function render() {
    elText.innerHTML = "";

    tokens.forEach((t, idx) => {
      const isWordToken = /[\p{L}\p{M}\p{N}]/u.test(t);

      if (!isWordToken) {
        const span = document.createElement("span");
        span.textContent = t;
        elText.appendChild(span);
        return;
      }

      const span = document.createElement("span");
      span.className = "w";
      span.textContent = t;

      const n = norm(t);
      const isAdj = ADJ.has(n);

      if (found.has(idx)) span.classList.add("correct");

      span.addEventListener("click", () => {
        if (found.has(idx)) return;

        if (isAdj) {
          found.add(idx);
          span.classList.add("correct");
          elScore.textContent = String(found.size);

          if (found.size === totalAdjs) {
            setFeedback("üéâ Fr√°b√¶rt! √û√∫ fannst √∂ll l√Ωsingaror√∞in.", true);
          } else {
            setFeedback("‚úÖ R√©tt! √ûetta er l√Ωsingaror√∞.");
          }
        } else {
          const pos = POS.get(n) || "anna√∞ / √≥√æekkt";
          span.classList.remove("wrongFlash");
          void span.offsetWidth; // endurr√¶sa animation
          span.classList.add("wrongFlash");
          setFeedback(`‚ùå Rangt. ‚Äû${t}‚Äú er ${pos}.`);
        }
      });

      elText.appendChild(span);

      // Bil √° eftir or√∞um nema n√¶sta token s√© greinarmerki sem √° a√∞ lo√∞a vi√∞
      const next = tokens[idx + 1] || "";
      const nextIsPunct = next && !/[\p{L}\p{M}\p{N}]/u.test(next);
      if (!nextIsPunct) elText.appendChild(document.createTextNode(" "));
    });
  }

  function reset() {
    found = new Set();
    elScore.textContent = "0";
    setFeedback("Byrja√∞u a√∞ smella √° or√∞.");
    render();
  }

  resetBtn.addEventListener("click", reset);

  render();
})();
</script>
</body>
</html>
