<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>L√Ωsingaror√∞ ‚Äì Settu or√∞in √° r√©ttan sta√∞</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    .drop-zone {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 120px;
      height: 36px;
      border: 2px dashed #d1d5db;
      border-radius: 8px;
      background: #f9fafb;
      vertical-align: middle;
      margin: 0 3px;
      padding: 0 8px;
      transition: border-color 0.15s, background 0.15s, transform 0.15s;
    }
    .drop-zone.has-word {
      border-style: solid;
      border-color: #3b82f6;
      background: #eff6ff;
      cursor: grab;
    }
    .drop-zone.drag-over {
      border-color: #2563eb;
      background: #dbeafe;
      transform: scale(1.04);
    }
    .drop-zone.correct {
      border-style: solid;
      border-color: #22c55e;
      background: #f0fdf4;
      color: #15803d;
      font-weight: 500;
      pointer-events: none;
    }
    .drop-zone.wrong {
      border-color: #ef4444;
      background: #fef2f2;
      animation: shake 0.4s ease;
    }
    @keyframes shake {
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-5px)}
      40%{transform:translateX(5px)}
      60%{transform:translateX(-4px)}
      80%{transform:translateX(3px)}
    }
    .drop-zone .word-label { font-size: 0.9rem; pointer-events: none; white-space: nowrap; }
    .word-chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.9rem;
      background: #eff6ff;
      border: 1.5px solid #93c5fd;
      color: #1e3a5f;
      padding: 6px 14px;
      border-radius: 999px;
      cursor: grab;
      user-select: none;
      touch-action: none;
      transition: transform 0.15s, box-shadow 0.15s, opacity 0.2s;
    }
    .word-chip:hover { box-shadow: 0 2px 8px rgba(59,130,246,0.25); transform: translateY(-1px); }
    .word-chip.dragging { opacity: 0.4; }
    .word-chip .gender-tag { font-size: 0.7rem; color: #3b82f6; font-style: italic; }
    .word-bank-drop { transition: border-color 0.15s, background 0.15s; }
    .word-bank-drop.drag-over-bank { border-color: #93c5fd !important; background: #eff6ff !important; }
    .drag-ghost {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      font-size: 0.9rem;
      background: #eff6ff;
      border: 1.5px solid #93c5fd;
      padding: 6px 14px;
      border-radius: 999px;
      opacity: 0.9;
      transform: translate(-50%, -50%);
      white-space: nowrap;
      display: none;
    }
  </style>
</head>
<body class="pb-16">

  <!-- Header -->
  <header class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-4xl mx-auto px-6 py-6">
      <button onclick="window.history.back()" class="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">‚Üê Til baka</button>
      <h1 class="text-3xl font-light text-gray-800 mb-1">L√Ωsingaror√∞ ‚Äì Settu or√∞in √° r√©ttan sta√∞</h1>
      <p class="text-gray-500 text-sm font-light">Drag-and-drop √¶fing ¬∑ L√Ωsingaror√∞</p>
    </div>
  </header>

  <main class="max-w-4xl mx-auto px-6 mt-6 space-y-6">

    <!-- Score bar -->
    <div id="scoreBar" class="hidden bg-white rounded-xl shadow-md p-5 flex items-center gap-4">
      <div id="scoreNum" class="text-3xl font-light text-blue-600 whitespace-nowrap"></div>
      <div>
        <div id="scoreTitle" class="font-normal text-gray-800 text-base"></div>
        <div id="scoreDetail" class="text-sm font-light text-gray-500 mt-0.5"></div>
      </div>
    </div>

    <!-- Text -->
    <section class="bg-white rounded-xl shadow-md p-8">
      <h2 class="text-xl font-light text-gray-800 mb-6">Settu r√©tt l√Ωsingaror√∞ inn √≠ fr√°s√∂gnina</h2>
      <div id="textBox" class="text-gray-700 font-light leading-10 text-base">
        √âg er <span class="drop-zone" data-answer="√æreyttur"></span> √≠ dag √æv√≠ √©g sofna√∞i l√≠ti√∞ √≠ n√≥tt.
        √ç morgun var str√¶t√≥inn <span class="drop-zone" data-answer="seinn"></span> og √©g √æurfti a√∞ hlaupa.
        √âg var <span class="drop-zone" data-answer="svangur"></span> eftir langan dag og bor√∞a√∞i <span class="drop-zone" data-answer="holla"></span> s√∫pu √≠ h√°deginu.
        Kennslustofan var <span class="drop-zone" data-answer="t√≥m"></span> eftir pr√≥fi√∞ √æv√≠ allir f√≥ru heim.
        √âg er <span class="drop-zone" data-answer="spenntur"></span> a√∞ hitta n√Ωja vinnuf√©lagann minn.
        √âg √° <span class="drop-zone" data-answer="n√Ωja"></span> sk√≥ sem √©g keypti √≠ g√¶r.
        Leikurinn √≠ g√¶r var mj√∂g <span class="drop-zone" data-answer="skemmtilegur"></span> og allir hl√≥gu.
        √öti er ve√∞ri√∞ <span class="drop-zone" data-answer="lei√∞inlegt"></span> og √æa√∞ er <span class="drop-zone" data-answer="kaldur"></span> vindur vi√∞ sj√≥inn.
        Vi√∞ s√°um <span class="drop-zone" data-answer="dj√∫pa"></span> tj√∂rn √≠ gar√∞inum.
      </div>
    </section>

    <!-- Word bank -->
    <section class="bg-white rounded-xl shadow-md p-6">
      <p class="text-sm font-light text-gray-500 mb-3 uppercase tracking-wide">Or√∞alisti ‚Äì drag√∞u or√∞in upp √≠ textann</p>
      <div id="wordBank" class="word-bank-drop flex flex-wrap gap-2 min-h-[52px] rounded-lg border-2 border-dashed border-gray-200 p-4"></div>
    </section>

    <!-- Buttons -->
    <div class="flex gap-3 flex-wrap">
      <button id="btnCheck"
        class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-normal transition-colors"
        disabled>Athuga sv√∂r</button>
      <button id="btnReset"
        class="hidden bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 font-normal transition-colors">Endurstilla</button>
    </div>

    <!-- Completion -->
    <div id="completionBox" class="hidden text-center py-8 bg-white rounded-xl shadow-md">
      <p class="text-2xl font-light text-gray-800 mb-1">üéâ Fr√°b√¶rlega unni√∞!</p>
      <p class="text-gray-500 font-light">Allar ey√∞ur eru r√©ttar.</p>
    </div>

  </main>

  <div class="drag-ghost" id="dragGhost"></div>

<script>
const WORDS = [
  { word:'√æreyttur',     gender:'kk'  },
  { word:'seinn',        gender:'kk'  },
  { word:'svangur',      gender:'kk'  },
  { word:'holla',        gender:'kvk' },
  { word:'t√≥m',          gender:'kvk' },
  { word:'spenntur',     gender:'kk'  },
  { word:'n√Ωja',         gender:'kk'  },
  { word:'skemmtilegur', gender:'kk'  },
  { word:'lei√∞inlegt',   gender:'hk'  },
  { word:'kaldur',       gender:'kk'  },
  { word:'dj√∫pa',        gender:'kvk' },
];

const wordBank = document.getElementById('wordBank');
const btnCheck = document.getElementById('btnCheck');
const btnReset = document.getElementById('btnReset');
const ghost    = document.getElementById('dragGhost');
const scoreBar = document.getElementById('scoreBar');

function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

const bankEntries = shuffle(WORDS.map((w,i)=>({...w,id:w.word+'_'+i})));

function buildBank(entries){ wordBank.innerHTML=''; entries.forEach(e=>wordBank.appendChild(makeChip(e))); }

function makeChip(e){
  const c=document.createElement('span');
  c.className='word-chip';
  c.dataset.word=e.word; c.dataset.chipId=e.id;
  c.innerHTML=`${e.word} <span class="gender-tag">${e.gender}</span>`;
  c.draggable=true;
  attachChip(c);
  return c;
}

let drag=null;

function attachChip(c){
  c.addEventListener('dragstart',e=>{drag={word:c.dataset.word,chipId:c.dataset.chipId,sourceZone:null};c.classList.add('dragging');e.dataTransfer.effectAllowed='move';});
  c.addEventListener('dragend',()=>c.classList.remove('dragging'));
  c.addEventListener('touchstart',onTS,{passive:false});
  c.addEventListener('touchmove',onTM,{passive:false});
  c.addEventListener('touchend',onTE);
}

document.querySelectorAll('.drop-zone').forEach(dz=>{
  dz.addEventListener('dragover',e=>{e.preventDefault();dz.classList.add('drag-over');});
  dz.addEventListener('dragleave',()=>dz.classList.remove('drag-over'));
  dz.addEventListener('drop',e=>{e.preventDefault();dz.classList.remove('drag-over');if(!drag)return;place(dz,drag.word,drag.chipId,drag.sourceZone);drag=null;});
  dz.addEventListener('dragstart',e=>{if(!dz.dataset.current)return;drag={word:dz.dataset.current,chipId:dz.dataset.chipId,sourceZone:dz};e.dataTransfer.effectAllowed='move';});
  dz.addEventListener('touchstart',e=>{if(!dz.dataset.current)return;onTS(e,dz);},{passive:false});
  dz.addEventListener('touchmove',onTM,{passive:false});
  dz.addEventListener('touchend',e=>onTE(e,dz));
});

wordBank.addEventListener('dragover',e=>{e.preventDefault();wordBank.classList.add('drag-over-bank');});
wordBank.addEventListener('dragleave',()=>wordBank.classList.remove('drag-over-bank'));
wordBank.addEventListener('drop',e=>{e.preventDefault();wordBank.classList.remove('drag-over-bank');if(!drag?.sourceZone)return;returnBank(drag.sourceZone);drag=null;});

function place(zone,word,chipId,srcZone){
  if(zone.dataset.current) returnBank(zone);
  if(srcZone===null){const c=wordBank.querySelector(`[data-chip-id="${chipId}"]`);if(c)c.remove();}
  else clearZone(srcZone);
  zone.dataset.current=word; zone.dataset.chipId=chipId;
  zone.classList.add('has-word'); zone.classList.remove('wrong','correct');
  zone.setAttribute('draggable','true');
  zone.innerHTML=`<span class="word-label">${word}</span>`;
  upd();
}

function returnBank(zone){
  const word=zone.dataset.current, chipId=zone.dataset.chipId;
  if(!word) return;
  const gender=WORDS.find(w=>w.word===word)?.gender||'';
  wordBank.appendChild(makeChip({word,gender,id:chipId}));
  clearZone(zone); upd();
}

function clearZone(z){
  z.dataset.current=''; z.dataset.chipId='';
  z.classList.remove('has-word','wrong','correct');
  z.setAttribute('draggable','false'); z.innerHTML='';
}

function upd(){
  const zones=[...document.querySelectorAll('.drop-zone')];
  btnCheck.disabled=!zones.every(z=>z.dataset.current||z.classList.contains('correct'));
}

btnCheck.addEventListener('click',()=>{
  const zones=[...document.querySelectorAll('.drop-zone')];
  let correct=0,wrong=0;
  zones.forEach(z=>{
    if(z.classList.contains('correct')){correct++;return;}
    if(z.dataset.current===z.dataset.answer){
      z.classList.remove('has-word','wrong'); z.classList.add('correct');
      z.setAttribute('draggable','false');
      z.innerHTML=`<span class="word-label">${z.dataset.current}</span><span class="ml-1 text-green-500 text-sm">‚úì</span>`;
      correct++;
    } else {
      z.classList.add('wrong'); wrong++;
      setTimeout(()=>returnBank(z),700);
    }
  });
  const total=zones.length, pct=Math.round(correct/total*100);
  document.getElementById('scoreNum').textContent=`${correct}/${total}`;
  document.getElementById('scoreTitle').textContent=pct===100?'Fr√°b√¶rt! Allt r√©tt! üéâ':pct>=70?'Vel gert! Pr√≥fa√∞u restina.':'Haltu √°fram! Settu r√∂ng or√∞ √° r√©ttan sta√∞.';
  document.getElementById('scoreDetail').textContent=wrong>0?`${wrong} or√∞ f√≥ru til baka √≠ listann.`:'Allar ey√∞ur eru r√©ttar!';
  scoreBar.classList.remove('hidden');
  scoreBar.scrollIntoView({behavior:'smooth',block:'nearest'});
  btnReset.classList.remove('hidden');
  if(correct===total) document.getElementById('completionBox').classList.remove('hidden');
  upd();
});

btnReset.addEventListener('click',()=>{
  document.querySelectorAll('.drop-zone').forEach(clearZone);
  buildBank(shuffle([...bankEntries]));
  scoreBar.classList.add('hidden');
  btnReset.classList.add('hidden');
  document.getElementById('completionBox').classList.add('hidden');
  upd();
});

// Touch
let tc={word:null,chipId:null,sourceZone:null};
function onTS(e,zoneOverride){
  const el=zoneOverride||e.currentTarget;
  const isZone=el.classList.contains('drop-zone');
  const word=isZone?el.dataset.current:el.dataset.word;
  if(!word)return;
  e.preventDefault();
  tc={word,chipId:el.dataset.chipId,sourceZone:isZone?el:null};
  ghost.textContent=word; ghost.style.display='block';
  const t=e.touches[0]; ghost.style.left=t.clientX+'px'; ghost.style.top=t.clientY+'px';
}
function onTM(e){
  if(!tc.word)return; e.preventDefault();
  const t=e.touches[0]; ghost.style.left=t.clientX+'px'; ghost.style.top=t.clientY+'px';
  document.querySelectorAll('.drop-zone').forEach(d=>d.classList.remove('drag-over'));
  document.elementFromPoint(t.clientX,t.clientY)?.closest('.drop-zone:not(.correct)')?.classList.add('drag-over');
}
function onTE(e){
  if(!tc.word)return;
  ghost.style.display='none';
  document.querySelectorAll('.drop-zone').forEach(d=>d.classList.remove('drag-over'));
  wordBank.classList.remove('drag-over-bank');
  const t=e.changedTouches[0];
  const el=document.elementFromPoint(t.clientX,t.clientY);
  const tz=el?.closest('.drop-zone:not(.correct)');
  const tb=el?.closest('#wordBank');
  if(tz) place(tz,tc.word,tc.chipId,tc.sourceZone);
  else if(tb&&tc.sourceZone) returnBank(tc.sourceZone);
  tc={word:null,chipId:null,sourceZone:null};
}

buildBank(bankEntries);
upd();
</script>
</body>
</html>
